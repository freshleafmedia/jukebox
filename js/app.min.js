(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var Jukebox = require("./jukebox.js").default;
var Search = require("./search.js").default;

var socket = io('//:3000');
socket.on('connect', function () {
    console.log('connected to websocket server');
    $('#playButton, #pauseButton, #volupButton, #voldownButton').removeClass('disabled');
});

socket.on('disconnect', function () {
    console.log('disconnected');
    $('.media-controls .btn, #shutdown').addClass('disabled');
});

var player = new Jukebox(socket);
var search = new Search(socket);

function notify(title, content) {
    if (window.Notification) {
        if (Notification.permission === "granted") {
            var notification = new Notification(title, { 'body': content, 'icon': '/favicon.ico' });
        } else {
            Notification.requestPermission(function (permission) {
                var notification = new Notification(title, { 'body': content, 'icon': '/favicon.ico' });
            });
        }
    }
}

function updateNowPlaying(title) {
    if (title == '') {
        $('title').text('Freshleaf Jukebox');
    } else {
        $('title').text(title + ' - Freshleaf Jukebox');
    }
}

$(window).on('scroll', function () {
    var y_scroll_pos = window.pageYOffset;
    var scroll_pos_test = 120; // set to whatever you want it to be

    if (y_scroll_pos > scroll_pos_test) {
        $('header').addClass('scrolled');
    } else {
        $('header').removeClass('scrolled');
    }
});

socket.on('playlist', function (playlistData) {
    player.setPlaylist(playlistData);
});

socket.on('songRemove', function (song) {
    player.getPlaylist().removeSong(song);
});

socket.on('songAdd', function (song) {
    notify('Song Added', song.data.title);
    player.getPlaylist().addSong(song);
});

socket.on('songStatus', function (song) {
    if (song.state === 'playing') {
        notify('Now Playing', song.data.title);
    }
    player.getPlaylist().updateSongStatus(song);
});

socket.on('songPosition', function (position) {
    player.getPlaylist().updateSongPosition(position);
});

navigator.serviceWorker.register('/worker.js', {
    scope: '/'
}).then(function (reg) {
    console.log('service worker registered', reg);
}, function (err) {
    console.log('service worker NOT registered', err);
});

},{"./jukebox.js":2,"./search.js":4}],2:[function(require,module,exports){
'use strict';

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Playlist = require("./playlist.js").default;

var Jukebox = (function () {
    function Jukebox(socket) {
        _classCallCheck(this, Jukebox);

        this.socket = socket;
        this.playlists = {};
        this.setEventHandlers();
    }

    _createClass(Jukebox, [{
        key: 'setEventHandlers',
        value: function setEventHandlers() {
            var _this = this;

            $('.media-controls').on('click', '.btn', function (e) {
                if ($(e.currentTarget).hasClass('disabled')) {
                    console.warn('Button disabled');
                    return;
                }

                // Get the action to send
                var action = $(e.currentTarget).attr('data-action');

                _this.control(action);
            });
        }
    }, {
        key: 'control',
        value: function control(action) {
            console.log('Sending action: ' + action);
            this.socket.emit('control', action);
        }
    }, {
        key: 'setPlaylist',
        value: function setPlaylist(playlistData) {
            // Try and add this playlist
            this.addPlaylist(playlistData);

            this.playlistID = playlistData.ID;
        }
    }, {
        key: 'addPlaylist',
        value: function addPlaylist(playlistData, overwrite) {
            // Check if we have already loaded this playlist
            if (overwrite === true || typeof this.playlists[playlistData.ID] === 'undefined') {
                this.playlists[playlistData.ID] = new Playlist(playlistData);
            }
        }
    }, {
        key: 'getPlaylist',
        value: function getPlaylist() {
            return this.playlists[this.playlistID];
        }
    }]);

    return Jukebox;
})();

exports.default = Jukebox;

},{"./playlist.js":3}],3:[function(require,module,exports){
'use strict';

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Playlist = (function () {
    function Playlist(playlistData) {
        _classCallCheck(this, Playlist);

        this.ID = playlistData.ID;
        this.songs = [];
        this.El = $('.queue-container');
        this.build(playlistData);
    }

    _createClass(Playlist, [{
        key: 'build',
        value: function build(playlistData) {
            $.each(playlistData.songs, (function (index, song) {

                this.addSong(song);
            }).bind(this));
        }
    }, {
        key: 'buildSong',
        value: function buildSong(song) {
            var item = $('<div />', { 'class': 'songResult', 'id': 'song-' + song.id, 'data-state': song.state });

            var image = $('<img />', { src: song.thumbnail });
            var duration = $('<p />', { 'class': 'duration', text: (song.data.duration / 60).toFixed(2) });
            var title = $('<p />', { 'class': 'title', text: song.data.title });
            var progress = $('<progress />', { value: song.position, max: song.data.duration });
            var username = $('<p />', { 'class': 'username', text: song.username });

            var imgwrap = $('<div />', { 'class': 'imageWrapper' });
            var contentwrap = $('<div />', { 'class': 'contentWrapper' });

            imgwrap.append(image);
            contentwrap.append(title);
            contentwrap.append(progress);
            item.append(imgwrap);
            item.append(contentwrap);
            item.append(username);
            item.append(duration);

            return item;
        }
    }, {
        key: 'removeSong',
        value: function removeSong(songToRemove) {
            this.El.children('#song-' + songToRemove.id).remove();

            for (var i = 0; i < this.songs.length; i++) {
                var song = this.songs[i];

                if (song.id === songToRemove.id) {
                    this.songs.splice(i, 1);
                    break;
                }
            }
        }
    }, {
        key: 'addSong',
        value: function addSong(song) {
            this.El.append(this.buildSong(song));
        }
    }, {
        key: 'updateSongStatus',
        value: function updateSongStatus(song) {
            var songEl = this.El.find('.songResult#song-' + song.id);
            songEl.attr('data-state', song.state);
            songEl.find('.duration').text((song.data.duration / 60).toFixed(2));
            songEl.find('progress').attr('value', song.position);
            songEl.find('progress').attr('max', song.data.duration);
        }
    }, {
        key: 'updateSongPosition',
        value: function updateSongPosition(position) {
            var songEl = this.El.find('.songResult[data-state=playing]');
            songEl.find('progress').attr('value', position);
        }
    }]);

    return Playlist;
})();

exports.default = Playlist;

},{}],4:[function(require,module,exports){
'use strict';

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Search = (function () {
    function Search(socket) {
        _classCallCheck(this, Search);

        this.socket = socket;
        this.dialogEl = $('#addDialog');
        this.userSetupEl = $('#user-setup');
        this.searchControlsEl = $('#search-controls');

        this.initUser();
        this.initGoogleApi(this.searchReady);
        this.initKeyEvents();
        this.initClickEvents();
    }

    _createClass(Search, [{
        key: 'initUser',
        value: function initUser() {
            var _this = this;

            if (localStorage.getItem('username')) {
                this.userSetupEl.hide();
                this.searchControlsEl.show();
            }
            $('#addUser').submit(function (e) {
                e.preventDefault();
                if ($('#username').val() != "") {
                    localStorage.setItem('username', $('#username').val());
                    _this.userSetupEl.hide();
                    _this.searchControlsEl.show();
                }
            });
        }
    }, {
        key: 'searchReady',
        value: function searchReady() {
            $('#search').prop('disabled', false);
        }
    }, {
        key: 'initGoogleApi',
        value: function initGoogleApi(callback) {
            setTimeout(googleApiClientReady, 1000);
            function googleApiClientReady() {
                gapi.client.setApiKey('AIzaSyC5ZNaxUE7HwOxi6r5xMq9aeRlUVdJXU7I');
                gapi.auth.init(function () {
                    gapi.client.load('youtube', 'v3', function () {
                        callback();
                    });
                });
            }
        }
    }, {
        key: 'initKeyEvents',
        value: function initKeyEvents() {
            var _this2 = this;

            $(document).keyup(function (event) {
                // Up/Down and j/k keys to navigate selecting a song
                if (event.keyCode == 40 || event.keyCode == 74) {
                    if ($('.highlight').length) {
                        var highlighted = $('.highlight');
                        highlighted.next().addClass('highlight');
                        highlighted.removeClass('highlight');
                    } else {
                        $('#search-container > .songResult:first-child').addClass('highlight');
                    }
                    return;
                }
                if (event.keyCode == 38 || event.keyCode == 75) {
                    if ($('.highlight').length) {
                        var highlighted = $('.highlight');
                        highlighted.prev().addClass('highlight');
                        highlighted.removeClass('highlight');
                    }
                    return;
                }
                // Esc closes dialog
                if (event.keyCode == 27) {
                    _this2.closeDialog();
                }
                // Run search on keydown in search box
                if ($(event.target).is('#search')) {
                    if (event.keyCode == 13 && $('.highlight').length) {
                        $('.highlight').click();
                        return;
                    }
                    _this2.search($('#search').val());
                }
                // Keys when form input isn't focused
                if (!$(event.target).is('input')) {
                    // A or Enter triggers dialog
                    if (event.keyCode == 65 || event.keyCode == 13) {
                        _this2.showDialog();
                    }
                }
            });
        }
    }, {
        key: 'search',
        value: function search(query) {
            var request = gapi.client.youtube.search.list({
                q: query,
                part: 'snippet',
                maxResults: '25'
            });

            request.execute(function (response) {
                $('#search-container').html('');
                $.each(response.result.items, function (index, item) {
                    if (item.id.kind == "youtube#video") {
                        var el = $('<div />', { 'class': 'songResult' });
                        el.data('url', item.id.videoId);
                        var image = $('<img />', { src: item.snippet.thumbnails.default.url });
                        var descWrap = $('<div />');
                        var title = $('<p />', { text: item.snippet.title, 'class': 'title' });
                        //var author = $('<p />', { text: item.snippet.channelTitle, 'class': 'description' });
                        descWrap.append(title);
                        //descWrap.append(author);
                        var imgwrap = $('<div />', { 'class': 'imageWrapper' });
                        imgwrap.append(image);
                        el.append(imgwrap);
                        el.append(descWrap);
                        $('#search-container').append(el);
                    }
                });
            });
        }
    }, {
        key: 'showDialog',
        value: function showDialog() {
            this.dialogEl.show();
            if (localStorage.getItem('username')) {
                $('#search').focus().val('');
            } else {
                $('#username').focus().val('');
            }
        }
    }, {
        key: 'closeDialog',
        value: function closeDialog() {
            this.dialogEl.hide();
        }
    }, {
        key: 'initClickEvents',
        value: function initClickEvents() {
            var _this3 = this;

            $('#addButton').click(function () {
                _this3.showDialog();
            });
            $('#addDialogClose, .overlay').click(function () {
                _this3.closeDialog();
            });
            $('#search-container').on('click', '> div', function (event) {
                var song = {
                    id: $(event.currentTarget).data('url'),
                    title: $(event.currentTarget).find('p.title').text(),
                    thumbnail: $(event.currentTarget).find('img').attr('src'),
                    username: localStorage.getItem('username')
                };
                _this3.addSongToPlaylist(song);
                $(event.currentTarget).addClass('added');
            });
        }
    }, {
        key: 'addSongToPlaylist',
        value: function addSongToPlaylist(song) {
            console.log('Adding.. ' + song.id);
            this.socket.emit('addsong', song);
        }
    }]);

    return Search;
})();

exports.default = Search;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9zb3VyY2UvYXBwLmpzIiwianMvc291cmNlL2p1a2Vib3guanMiLCJqcy9zb3VyY2UvcGxheWxpc3QuanMiLCJqcy9zb3VyY2Uvc2VhcmNoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxJQUFJLE9BQU8sR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDO0FBQzlDLElBQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUM7O0FBRTVDLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUMzQixNQUFNLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxZQUFVO0FBQzNCLFdBQU8sQ0FBQyxHQUFHLENBQUMsK0JBQStCLENBQUMsQ0FBQztBQUM3QyxLQUFDLENBQUMseURBQXlELENBQUMsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7Q0FDeEYsQ0FBQyxDQUFDOztBQUVILE1BQU0sQ0FBQyxFQUFFLENBQUMsWUFBWSxFQUFFLFlBQVU7QUFDOUIsV0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUM1QixLQUFDLENBQUMsaUNBQWlDLENBQUMsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7Q0FDN0QsQ0FBQyxDQUFDOztBQUVILElBQUksTUFBTSxHQUFHLElBQUksT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ2pDLElBQUksTUFBTSxHQUFHLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDOztBQUVoQyxTQUFTLE1BQU0sQ0FBQyxLQUFLLEVBQUUsT0FBTyxFQUFFO0FBQzVCLFFBQUksTUFBTSxDQUFDLFlBQVksRUFBRTtBQUNyQixZQUFJLFlBQVksQ0FBQyxVQUFVLEtBQUssU0FBUyxFQUFFO0FBQ3ZD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Q0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztTQUNyQzs7O1dBaEtnQixNQUFNOzs7a0JBQU4sTUFBTSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgSnVrZWJveCA9IHJlcXVpcmUoXCIuL2p1a2Vib3guanNcIikuZGVmYXVsdDtcbnZhciBTZWFyY2ggPSByZXF1aXJlKFwiLi9zZWFyY2guanNcIikuZGVmYXVsdDtcblxudmFyIHNvY2tldCA9IGlvKCcvLzozMDAwJyk7XG5zb2NrZXQub24oJ2Nvbm5lY3QnLCBmdW5jdGlvbigpe1xuICAgIGNvbnNvbGUubG9nKCdjb25uZWN0ZWQgdG8gd2Vic29ja2V0IHNlcnZlcicpO1xuICAgICQoJyNwbGF5QnV0dG9uLCAjcGF1c2VCdXR0b24sICN2b2x1cEJ1dHRvbiwgI3ZvbGRvd25CdXR0b24nKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbn0pO1xuXG5zb2NrZXQub24oJ2Rpc2Nvbm5lY3QnLCBmdW5jdGlvbigpe1xuICAgIGNvbnNvbGUubG9nKCdkaXNjb25uZWN0ZWQnKTtcbiAgICAkKCcubWVkaWEtY29udHJvbHMgLmJ0biwgI3NodXRkb3duJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG59KTtcblxudmFyIHBsYXllciA9IG5ldyBKdWtlYm94KHNvY2tldCk7XG52YXIgc2VhcmNoID0gbmV3IFNlYXJjaChzb2NrZXQpO1xuXG5mdW5jdGlvbiBub3RpZnkodGl0bGUsIGNvbnRlbnQpIHtcbiAgICBpZiAod2luZG93Lk5vdGlmaWNhdGlvbikge1xuICAgICAgICBpZiAoTm90aWZpY2F0aW9uLnBlcm1pc3Npb24gPT09IFwiZ3JhbnRlZFwiKSB7XG4gICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gbmV3IE5vdGlmaWNhdGlvbih0aXRsZSwgeyAnYm9keSc6IGNvbnRlbnQsICdpY29uJzogJy9mYXZpY29uLmljbycgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBOb3RpZmljYXRpb24ucmVxdWVzdFBlcm1pc3Npb24oZnVuY3Rpb24ocGVybWlzc2lvbikge1xuICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBuZXcgTm90aWZpY2F0aW9uKHRpdGxlLCB7ICdib2R5JzogY29udGVudCwgJ2ljb24nOiAnL2Zhdmljb24uaWNvJyB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVOb3dQbGF5aW5nKHRpdGxlKSB7XG4gICAgaWYgKHRpdGxlID09ICcnKSB7XG4gICAgICAgICQoJ3RpdGxlJykudGV4dCgnRnJlc2hsZWFmIEp1a2Vib3gnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAkKCd0aXRsZScpLnRleHQodGl0bGUgKyAnIC0gRnJlc2hsZWFmIEp1a2Vib3gnKTtcbiAgICB9XG59XG5cbiQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG4gICAgdmFyIHlfc2Nyb2xsX3BvcyA9IHdpbmRvdy5wYWdlWU9mZnNldDtcbiAgICB2YXIgc2Nyb2xsX3Bvc190ZXN0ID0gMTIwOyAgICAgICAgICAgICAvLyBzZXQgdG8gd2hhdGV2ZXIgeW91IHdhbnQgaXQgdG8gYmVcblxuICAgIGlmKHlfc2Nyb2xsX3BvcyA+IHNjcm9sbF9wb3NfdGVzdCkge1xuICAgICAgICAkKCdoZWFkZXInKS5hZGRDbGFzcygnc2Nyb2xsZWQnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgICQoJ2hlYWRlcicpLnJlbW92ZUNsYXNzKCdzY3JvbGxlZCcpO1xuICAgIH1cbn0pO1xuXG5zb2NrZXQub24oJ3BsYXlsaXN0JywgZnVuY3Rpb24ocGxheWxpc3REYXRhKSB7XG4gICAgcGxheWVyLnNldFBsYXlsaXN0KHBsYXlsaXN0RGF0YSk7XG59KTtcblxuc29ja2V0Lm9uKCdzb25nUmVtb3ZlJywgZnVuY3Rpb24oc29uZykge1xuICAgIHBsYXllci5nZXRQbGF5bGlzdCgpLnJlbW92ZVNvbmcoc29uZyk7XG59KTtcblxuc29ja2V0Lm9uKCdzb25nQWRkJywgZnVuY3Rpb24oc29uZykge1xuICAgIG5vdGlmeSgnU29uZyBBZGRlZCcsIHNvbmcuZGF0YS50aXRsZSk7XG4gICAgcGxheWVyLmdldFBsYXlsaXN0KCkuYWRkU29uZyhzb25nKTtcbn0pO1xuXG5zb2NrZXQub24oJ3NvbmdTdGF0dXMnLCBmdW5jdGlvbihzb25nKSB7XG4gICAgaWYoc29uZy5zdGF0ZSA9PT0gJ3BsYXlpbmcnKSB7XG4gICAgICAgIG5vdGlmeSgnTm93IFBsYXlpbmcnLCBzb25nLmRhdGEudGl0bGUpO1xuICAgIH1cbiAgICBwbGF5ZXIuZ2V0UGxheWxpc3QoKS51cGRhdGVTb25nU3RhdHVzKHNvbmcpO1xufSk7XG5cbnNvY2tldC5vbignc29uZ1Bvc2l0aW9uJywgZnVuY3Rpb24ocG9zaXRpb24pIHtcbiAgICBwbGF5ZXIuZ2V0UGxheWxpc3QoKS51cGRhdGVTb25nUG9zaXRpb24ocG9zaXRpb24pO1xufSk7XG5cbm5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCcvd29ya2VyLmpzJywge1xuICAgIHNjb3BlOiAnLydcbn0pLnRoZW4oZnVuY3Rpb24ocmVnKSB7XG4gICAgY29uc29sZS5sb2coJ3NlcnZpY2Ugd29ya2VyIHJlZ2lzdGVyZWQnLCByZWcpO1xufSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgY29uc29sZS5sb2coJ3NlcnZpY2Ugd29ya2VyIE5PVCByZWdpc3RlcmVkJywgZXJyKTtcbn0pOyIsInZhciBQbGF5bGlzdCA9IHJlcXVpcmUoXCIuL3BsYXlsaXN0LmpzXCIpLmRlZmF1bHQ7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEp1a2Vib3hcbntcbiAgICBjb25zdHJ1Y3Rvcihzb2NrZXQpXG4gICAge1xuICAgICAgICB0aGlzLnNvY2tldCA9IHNvY2tldDtcbiAgICAgICAgdGhpcy5wbGF5bGlzdHMgPSB7fTtcbiAgICAgICAgdGhpcy5zZXRFdmVudEhhbmRsZXJzKCk7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRIYW5kbGVycygpIHtcbiAgICAgICAgJCgnLm1lZGlhLWNvbnRyb2xzJykub24oJ2NsaWNrJywgJy5idG4nLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCQoZS5jdXJyZW50VGFyZ2V0KS5oYXNDbGFzcygnZGlzYWJsZWQnKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignQnV0dG9uIGRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGFjdGlvbiB0byBzZW5kXG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gJChlLmN1cnJlbnRUYXJnZXQpLmF0dHIoJ2RhdGEtYWN0aW9uJyk7XG5cbiAgICAgICAgICAgIHRoaXMuY29udHJvbChhY3Rpb24pO1xuICAgICAgICB9KTtcblxuICAgIH1cblxuICAgIGNvbnRyb2woYWN0aW9uKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTZW5kaW5nIGFjdGlvbjogJythY3Rpb24pO1xuICAgICAgICB0aGlzLnNvY2tldC5lbWl0KCdjb250cm9sJywgYWN0aW9uKTtcbiAgICB9XG5cbiAgICBzZXRQbGF5bGlzdChwbGF5bGlzdERhdGEpXG4gICAge1xuICAgICAgICAvLyBUcnkgYW5kIGFkZCB0aGlzIHBsYXlsaXN0XG4gICAgICAgIHRoaXMuYWRkUGxheWxpc3QocGxheWxpc3REYXRhKTtcblxuICAgICAgICB0aGlzLnBsYXlsaXN0SUQgPSBwbGF5bGlzdERhdGEuSUQ7XG4gICAgfVxuXG4gICAgYWRkUGxheWxpc3QocGxheWxpc3REYXRhLCBvdmVyd3JpdGUpXG4gICAge1xuICAgICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGFscmVhZHkgbG9hZGVkIHRoaXMgcGxheWxpc3RcbiAgICAgICAgaWYgKG92ZXJ3cml0ZSA9PT0gdHJ1ZSB8fCB0eXBlb2YgdGhpcy5wbGF5bGlzdHNbcGxheWxpc3REYXRhLklEXSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRoaXMucGxheWxpc3RzW3BsYXlsaXN0RGF0YS5JRF0gPSBuZXcgUGxheWxpc3QocGxheWxpc3REYXRhKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFBsYXlsaXN0KClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnBsYXlsaXN0c1t0aGlzLnBsYXlsaXN0SURdO1xuICAgIH1cbn1cblxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQbGF5bGlzdCB7XG5cbiAgICBjb25zdHJ1Y3RvcihwbGF5bGlzdERhdGEpIHtcbiAgICAgICAgdGhpcy5JRCA9IHBsYXlsaXN0RGF0YS5JRDtcbiAgICAgICAgdGhpcy5zb25ncyA9IFtdO1xuICAgICAgICB0aGlzLkVsID0gJCgnLnF1ZXVlLWNvbnRhaW5lcicpO1xuICAgICAgICB0aGlzLmJ1aWxkKHBsYXlsaXN0RGF0YSk7XG4gICAgfVxuXG4gICAgYnVpbGQocGxheWxpc3REYXRhKVxuICAgIHtcbiAgICAgICAgJC5lYWNoKHBsYXlsaXN0RGF0YS5zb25ncywgZnVuY3Rpb24oaW5kZXgsIHNvbmcpIHtcblxuICAgICAgICAgICAgdGhpcy5hZGRTb25nKHNvbmcpO1xuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgYnVpbGRTb25nKHNvbmcpXG4gICAge1xuICAgICAgICB2YXIgaXRlbSA9ICQoJzxkaXYgLz4nLCB7ICdjbGFzcyc6ICdzb25nUmVzdWx0JywgJ2lkJzogJ3NvbmctJytzb25nLmlkLCAnZGF0YS1zdGF0ZSc6IHNvbmcuc3RhdGUgfSk7XG5cbiAgICAgICAgdmFyIGltYWdlID0gJCgnPGltZyAvPicsIHsgc3JjOiBzb25nLnRodW1ibmFpbCB9KTtcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gJCgnPHAgLz4nLCB7ICdjbGFzcyc6ICdkdXJhdGlvbicsIHRleHQ6IChzb25nLmRhdGEuZHVyYXRpb24gLyA2MCkudG9GaXhlZCgyKSB9KTtcbiAgICAgICAgdmFyIHRpdGxlID0gJCgnPHAgLz4nLCB7ICdjbGFzcyc6ICd0aXRsZScsIHRleHQ6IHNvbmcuZGF0YS50aXRsZSB9KTtcbiAgICAgICAgdmFyIHByb2dyZXNzID0gJCgnPHByb2dyZXNzIC8+JywgeyB2YWx1ZTogc29uZy5wb3NpdGlvbiwgbWF4OiBzb25nLmRhdGEuZHVyYXRpb24gfSk7XG4gICAgICAgIHZhciB1c2VybmFtZSA9ICQoJzxwIC8+JywgeyAnY2xhc3MnOiAndXNlcm5hbWUnLCB0ZXh0OiBzb25nLnVzZXJuYW1lIH0pO1xuXG4gICAgICAgIHZhciBpbWd3cmFwID0gJCgnPGRpdiAvPicsIHsgJ2NsYXNzJzogJ2ltYWdlV3JhcHBlcicgfSk7XG4gICAgICAgIHZhciBjb250ZW50d3JhcCA9ICQoJzxkaXYgLz4nLCB7ICdjbGFzcyc6ICdjb250ZW50V3JhcHBlcicgfSk7XG5cbiAgICAgICAgaW1nd3JhcC5hcHBlbmQoaW1hZ2UpO1xuICAgICAgICBjb250ZW50d3JhcC5hcHBlbmQodGl0bGUpO1xuICAgICAgICBjb250ZW50d3JhcC5hcHBlbmQocHJvZ3Jlc3MpO1xuICAgICAgICBpdGVtLmFwcGVuZChpbWd3cmFwKTtcbiAgICAgICAgaXRlbS5hcHBlbmQoY29udGVudHdyYXApO1xuICAgICAgICBpdGVtLmFwcGVuZCh1c2VybmFtZSk7XG4gICAgICAgIGl0ZW0uYXBwZW5kKGR1cmF0aW9uKTtcblxuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICB9XG5cbiAgICByZW1vdmVTb25nKHNvbmdUb1JlbW92ZSlcbiAgICB7XG4gICAgICAgIHRoaXMuRWwuY2hpbGRyZW4oJyNzb25nLScrc29uZ1RvUmVtb3ZlLmlkKS5yZW1vdmUoKTtcblxuICAgICAgICBmb3IgKHZhciBpPTA7IGk8dGhpcy5zb25ncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHNvbmcgPSB0aGlzLnNvbmdzW2ldO1xuXG4gICAgICAgICAgICBpZihzb25nLmlkID09PSBzb25nVG9SZW1vdmUuaWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNvbmdzLnNwbGljZShpLDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWRkU29uZyhzb25nKVxuICAgIHtcbiAgICAgICAgdGhpcy5FbC5hcHBlbmQodGhpcy5idWlsZFNvbmcoc29uZykpO1xuICAgIH1cblxuICAgIHVwZGF0ZVNvbmdTdGF0dXMoc29uZylcbiAgICB7XG4gICAgICAgIHZhciBzb25nRWwgPSB0aGlzLkVsLmZpbmQoJy5zb25nUmVzdWx0I3NvbmctJyArIHNvbmcuaWQpO1xuICAgICAgICBzb25nRWwuYXR0cignZGF0YS1zdGF0ZScsIHNvbmcuc3RhdGUpO1xuICAgICAgICBzb25nRWwuZmluZCgnLmR1cmF0aW9uJykudGV4dCgoc29uZy5kYXRhLmR1cmF0aW9uIC8gNjApLnRvRml4ZWQoMikpO1xuICAgICAgICBzb25nRWwuZmluZCgncHJvZ3Jlc3MnKS5hdHRyKCd2YWx1ZScsIHNvbmcucG9zaXRpb24pO1xuICAgICAgICBzb25nRWwuZmluZCgncHJvZ3Jlc3MnKS5hdHRyKCdtYXgnLCBzb25nLmRhdGEuZHVyYXRpb24pO1xuICAgIH1cblxuICAgIHVwZGF0ZVNvbmdQb3NpdGlvbihwb3NpdGlvbilcbiAgICB7XG4gICAgICAgIHZhciBzb25nRWwgPSB0aGlzLkVsLmZpbmQoJy5zb25nUmVzdWx0W2RhdGEtc3RhdGU9cGxheWluZ10nKTtcbiAgICAgICAgc29uZ0VsLmZpbmQoJ3Byb2dyZXNzJykuYXR0cigndmFsdWUnLCBwb3NpdGlvbik7XG4gICAgfVxufVxuXG5cblxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VhcmNoXG57XG4gICAgY29uc3RydWN0b3Ioc29ja2V0KSB7XG4gICAgICAgIHRoaXMuc29ja2V0ID0gc29ja2V0O1xuICAgICAgICB0aGlzLmRpYWxvZ0VsID0gJCgnI2FkZERpYWxvZycpO1xuICAgICAgICB0aGlzLnVzZXJTZXR1cEVsID0gJCgnI3VzZXItc2V0dXAnKTtcbiAgICAgICAgdGhpcy5zZWFyY2hDb250cm9sc0VsID0gJCgnI3NlYXJjaC1jb250cm9scycpO1xuXG4gICAgICAgIHRoaXMuaW5pdFVzZXIoKTtcbiAgICAgICAgdGhpcy5pbml0R29vZ2xlQXBpKHRoaXMuc2VhcmNoUmVhZHkpO1xuICAgICAgICB0aGlzLmluaXRLZXlFdmVudHMoKTtcbiAgICAgICAgdGhpcy5pbml0Q2xpY2tFdmVudHMoKTtcbiAgICB9XG5cbiAgICBpbml0VXNlcigpXG4gICAge1xuICAgICAgICBpZihsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcm5hbWUnKSkge1xuICAgICAgICAgICAgdGhpcy51c2VyU2V0dXBFbC5oaWRlKCk7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaENvbnRyb2xzRWwuc2hvdygpO1xuICAgICAgICB9XG4gICAgICAgICQoJyNhZGRVc2VyJykuc3VibWl0KChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBpZiAoJCgnI3VzZXJuYW1lJykudmFsKCkgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VybmFtZScsICQoJyN1c2VybmFtZScpLnZhbCgpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZXJTZXR1cEVsLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaENvbnRyb2xzRWwuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZWFyY2hSZWFkeSgpXG4gICAge1xuICAgICAgICAkKCcjc2VhcmNoJykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgaW5pdEdvb2dsZUFwaShjYWxsYmFjaylcbiAgICB7XG4gICAgICAgIHNldFRpbWVvdXQoZ29vZ2xlQXBpQ2xpZW50UmVhZHksIDEwMDApO1xuICAgICAgICBmdW5jdGlvbiBnb29nbGVBcGlDbGllbnRSZWFkeSgpIHtcbiAgICAgICAgICAgIGdhcGkuY2xpZW50LnNldEFwaUtleSgnQUl6YVN5QzVaTmF4VUU3SHdPeGk2cjV4TXE5YWVSbFVWZEpYVTdJJyk7XG4gICAgICAgICAgICBnYXBpLmF1dGguaW5pdChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBnYXBpLmNsaWVudC5sb2FkKCd5b3V0dWJlJywgJ3YzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpbml0S2V5RXZlbnRzKCkge1xuICAgICAgICAkKGRvY3VtZW50KS5rZXl1cCgoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vIFVwL0Rvd24gYW5kIGovayBrZXlzIHRvIG5hdmlnYXRlIHNlbGVjdGluZyBhIHNvbmdcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09IDQwIHx8IGV2ZW50LmtleUNvZGUgPT0gNzQpIHtcbiAgICAgICAgICAgICAgICBpZiAoJCgnLmhpZ2hsaWdodCcpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGlnaGxpZ2h0ZWQgPSAkKCcuaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkLm5leHQoKS5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkKCcjc2VhcmNoLWNvbnRhaW5lciA+IC5zb25nUmVzdWx0OmZpcnN0LWNoaWxkJykuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAzOCB8fCBldmVudC5rZXlDb2RlID09IDc1KSB7XG4gICAgICAgICAgICAgICAgaWYgKCQoJy5oaWdobGlnaHQnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhpZ2hsaWdodGVkID0gJCgnLmhpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRlZC5wcmV2KCkuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRlZC5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEVzYyBjbG9zZXMgZGlhbG9nXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAyNykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFJ1biBzZWFyY2ggb24ga2V5ZG93biBpbiBzZWFyY2ggYm94XG4gICAgICAgICAgICBpZiAoJChldmVudC50YXJnZXQpLmlzKCcjc2VhcmNoJykpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAxMyAmJiAkKCcuaGlnaGxpZ2h0JykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJy5oaWdobGlnaHQnKS5jbGljaygpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoKCQoJyNzZWFyY2gnKS52YWwoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBLZXlzIHdoZW4gZm9ybSBpbnB1dCBpc24ndCBmb2N1c2VkXG4gICAgICAgICAgICBpZiAoISQoZXZlbnQudGFyZ2V0KS5pcygnaW5wdXQnKSkge1xuICAgICAgICAgICAgICAgIC8vIEEgb3IgRW50ZXIgdHJpZ2dlcnMgZGlhbG9nXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gNjUgfHwgZXZlbnQua2V5Q29kZSA9PSAxMykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dEaWFsb2coKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNlYXJjaChxdWVyeSlcbiAgICB7XG4gICAgICAgIHZhciByZXF1ZXN0ID0gZ2FwaS5jbGllbnQueW91dHViZS5zZWFyY2gubGlzdCh7XG4gICAgICAgICAgICBxOiBxdWVyeSxcbiAgICAgICAgICAgIHBhcnQ6ICdzbmlwcGV0JyxcbiAgICAgICAgICAgIG1heFJlc3VsdHM6ICcyNSdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmVxdWVzdC5leGVjdXRlKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgJCgnI3NlYXJjaC1jb250YWluZXInKS5odG1sKCcnKTtcbiAgICAgICAgICAgICQuZWFjaChyZXNwb25zZS5yZXN1bHQuaXRlbXMsIGZ1bmN0aW9uIChpbmRleCwgaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLmlkLmtpbmQgPT0gXCJ5b3V0dWJlI3ZpZGVvXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsID0gJCgnPGRpdiAvPicsIHsnY2xhc3MnOiAnc29uZ1Jlc3VsdCd9KTtcbiAgICAgICAgICAgICAgICAgICAgZWwuZGF0YSgndXJsJywgaXRlbS5pZC52aWRlb0lkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlID0gJCgnPGltZyAvPicsIHtzcmM6IGl0ZW0uc25pcHBldC50aHVtYm5haWxzLmRlZmF1bHQudXJsfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXNjV3JhcCA9ICQoJzxkaXYgLz4nKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gJCgnPHAgLz4nLCB7dGV4dDogaXRlbS5zbmlwcGV0LnRpdGxlLCAnY2xhc3MnOiAndGl0bGUnfSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdmFyIGF1dGhvciA9ICQoJzxwIC8+JywgeyB0ZXh0OiBpdGVtLnNuaXBwZXQuY2hhbm5lbFRpdGxlLCAnY2xhc3MnOiAnZGVzY3JpcHRpb24nIH0pO1xuICAgICAgICAgICAgICAgICAgICBkZXNjV3JhcC5hcHBlbmQodGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAvL2Rlc2NXcmFwLmFwcGVuZChhdXRob3IpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW1nd3JhcCA9ICQoJzxkaXYgLz4nLCB7J2NsYXNzJzogJ2ltYWdlV3JhcHBlcid9KTtcbiAgICAgICAgICAgICAgICAgICAgaW1nd3JhcC5hcHBlbmQoaW1hZ2UpO1xuICAgICAgICAgICAgICAgICAgICBlbC5hcHBlbmQoaW1nd3JhcCk7XG4gICAgICAgICAgICAgICAgICAgIGVsLmFwcGVuZChkZXNjV3JhcCk7XG4gICAgICAgICAgICAgICAgICAgICQoJyNzZWFyY2gtY29udGFpbmVyJykuYXBwZW5kKGVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzaG93RGlhbG9nKCkge1xuICAgICAgICB0aGlzLmRpYWxvZ0VsLnNob3coKTtcbiAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VybmFtZScpKSB7XG4gICAgICAgICAgICAkKCcjc2VhcmNoJykuZm9jdXMoKS52YWwoJycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJCgnI3VzZXJuYW1lJykuZm9jdXMoKS52YWwoJycpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xvc2VEaWFsb2coKVxuICAgIHtcbiAgICAgICAgdGhpcy5kaWFsb2dFbC5oaWRlKCk7XG4gICAgfVxuXG4gICAgaW5pdENsaWNrRXZlbnRzKClcbiAgICB7XG4gICAgICAgICQoJyNhZGRCdXR0b24nKS5jbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNob3dEaWFsb2coKTtcbiAgICAgICAgfSk7XG4gICAgICAgICQoJyNhZGREaWFsb2dDbG9zZSwgLm92ZXJsYXknKS5jbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7XG4gICAgICAgIH0pO1xuICAgICAgICAkKCcjc2VhcmNoLWNvbnRhaW5lcicpLm9uKCdjbGljaycsICc+IGRpdicsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdmFyIHNvbmcgPSB7XG4gICAgICAgICAgICAgICAgaWQ6ICQoZXZlbnQuY3VycmVudFRhcmdldCkuZGF0YSgndXJsJyksXG4gICAgICAgICAgICAgICAgdGl0bGU6ICQoZXZlbnQuY3VycmVudFRhcmdldCkuZmluZCgncC50aXRsZScpLnRleHQoKSxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6ICQoZXZlbnQuY3VycmVudFRhcmdldCkuZmluZCgnaW1nJykuYXR0cignc3JjJyksXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VybmFtZScpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5hZGRTb25nVG9QbGF5bGlzdChzb25nKTtcbiAgICAgICAgICAgICQoZXZlbnQuY3VycmVudFRhcmdldCkuYWRkQ2xhc3MoJ2FkZGVkJyk7XG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgYWRkU29uZ1RvUGxheWxpc3Qoc29uZylcbiAgICB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBZGRpbmcuLiAnICsgc29uZy5pZCk7XG4gICAgICAgIHRoaXMuc29ja2V0LmVtaXQoJ2FkZHNvbmcnLCBzb25nKTtcbiAgICB9XG59Il19
