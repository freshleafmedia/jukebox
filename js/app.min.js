(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var JukeboxController = require("./controllers/ApplicationController.js").default;
var socket = io('//:3000');

new JukeboxController(socket);

// ----

$(window).on('scroll', function () {
    var y_scroll_pos = window.pageYOffset;
    var scroll_pos_test = 120; // set to whatever you want it to be

    if (y_scroll_pos > scroll_pos_test) {
        $('header').addClass('scrolled');
    } else {
        $('header').removeClass('scrolled');
    }
});

if (typeof navigator.serviceWorker !== 'undefined') {
    navigator.serviceWorker.register('/worker.js', {
        scope: '/'
    }).then(function (reg) {
        console.log('service worker registered', reg);
    }, function (err) {
        console.log('service worker NOT registered', err);
    });
}

},{"./controllers/ApplicationController.js":4}],2:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = {
    soundbites: require('./soundbites').default
};

},{"./soundbites":3}],3:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = {
    sounds: ['YLgKPEhyg3k', 'cdEQmpVIE4A', 'kD_xWrhZ8yI']
};

},{}],4:[function(require,module,exports){
"use strict";

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var SearchController = require("./SearchController.js").default;
var Playlist = require("./PlaylistController.js").default;
var SoundbitesController = require("./SoundbitesController.js").default;
var notify = require("../helpers/notifications.js").notify;

var ApplicationController = (function () {
    function ApplicationController(socket) {
        _classCallCheck(this, ApplicationController);

        this.socket = socket;
        this.playlists = {};
        this.setEventHandlers();
        new SearchController(socket);
        this.setupSockets();
        new SoundbitesController();
    }

    _createClass(ApplicationController, [{
        key: "setupSockets",
        value: function setupSockets() {
            var _this = this;

            this.socket.on('connect', function () {
                console.log('connected to websocket server');
                $('#playButton, #pauseButton, #volupButton, #voldownButton, #shuffleSongs, #forwardButton').removeClass('disabled');
            });

            this.socket.on('disconnect', function () {
                console.log('disconnected');
                $('.media-controls .btn, #shutdown, #shuffleSongs').addClass('disabled');
            });
            this.socket.on('playlist', function (playlistData) {
                _this.setPlaylist(playlistData);
            });

            this.socket.on('songRemove', function (song) {
                _this.getPlaylist().removeSong(song);
            });

            this.socket.on('songAdd', function (song) {
                notify('Song Added', song.data.title);
            });

            this.socket.on('songStatus', function (song) {
                if (song.state === 'playing') {
                    notify('Now Playing', song.data.title);
                    _this.updateNowPlaying(song.data.title);
                }
                _this.getPlaylist().updateSongStatus(song);
            });

            this.socket.on('songPosition', function (position) {
                _this.getPlaylist().updateSongPosition(position);
            });
        }
    }, {
        key: "setEventHandlers",
        value: function setEventHandlers() {
            var _this2 = this;

            $(document).on('click', 'button[data-action]', function (e) {
                if ($(e.currentTarget).hasClass('disabled')) {
                    console.warn('Button disabled');
                    return;
                }

                // Get the action to send
                var action = $(e.currentTarget).attr('data-action');

                _this2.control(action);
            });
        }
    }, {
        key: "control",
        value: function control(action) {
            console.log('Sending action: ' + action);
            this.socket.emit('control', action);
        }
    }, {
        key: "setPlaylist",
        value: function setPlaylist(playlistData) {
            // Try and add this playlist
            this.addPlaylist(playlistData, true);

            this.playlistID = playlistData.ID;
        }
    }, {
        key: "addPlaylist",
        value: function addPlaylist(playlistData, overwrite) {
            // Check if we have already loaded this playlist
            if (overwrite === true || typeof this.playlists[playlistData.ID] === 'undefined') {
                this.playlists[playlistData.ID] = new Playlist(playlistData);
            }
        }
    }, {
        key: "getPlaylist",
        value: function getPlaylist() {
            return this.playlists[this.playlistID];
        }
    }, {
        key: "updateNowPlaying",
        value: function updateNowPlaying(title) {
            if (title == '') {
                $('title').text('Freshleaf Jukebox');
            } else {
                $('title').text(title + ' - Freshleaf Jukebox');
            }
        }
    }]);

    return ApplicationController;
})();

exports.default = ApplicationController;

},{"../helpers/notifications.js":8,"./PlaylistController.js":5,"./SearchController.js":6,"./SoundbitesController.js":7}],5:[function(require,module,exports){
'use strict';

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var PlaylistController = (function () {
    function PlaylistController(playlistData) {
        _classCallCheck(this, PlaylistController);

        this.ID = playlistData.ID;
        this.songs = [];
        this.El = $('.queue-container');
        this.build(playlistData);
    }

    _createClass(PlaylistController, [{
        key: 'build',
        value: function build(playlistData) {
            //Clear the current playlist
            this.El.html('');

            $.each(playlistData.songs, (function (index, song) {

                this.addSong(song);
            }).bind(this));
        }
    }, {
        key: 'buildSong',
        value: function buildSong(song) {
            var item = $('<div />', { 'class': 'songResult', 'id': 'song-' + song.id, 'data-state': song.state });

            var image = $('<img />', { src: song.thumbnail });
            var duration = $('<p />', { 'class': 'duration', text: (song.data.duration / 60).toFixed(2) });
            var title = $('<p />', { 'class': 'title', text: song.data.title });
            var progress = $('<progress />', { value: song.position, max: song.data.duration });
            var username = $('<p />', { 'class': 'username', text: song.username });

            var imgwrap = $('<div />', { 'class': 'imageWrapper' });
            var contentwrap = $('<div />', { 'class': 'contentWrapper' });

            imgwrap.append(image);
            contentwrap.append(title);
            contentwrap.append(progress);
            item.append(imgwrap);
            item.append(contentwrap);
            item.append(username);
            item.append(duration);

            return item;
        }
    }, {
        key: 'removeSong',
        value: function removeSong(songToRemove) {
            this.El.children('#song-' + songToRemove.id).remove();

            for (var i = 0; i < this.songs.length; i++) {
                var song = this.songs[i];

                if (song.id === songToRemove.id) {
                    this.songs.splice(i, 1);
                    break;
                }
            }
        }
    }, {
        key: 'addSong',
        value: function addSong(song) {
            this.El.append(this.buildSong(song));
        }
    }, {
        key: 'updateSongStatus',
        value: function updateSongStatus(song) {
            var songEl = this.El.find('.songResult#song-' + song.id);
            songEl.attr('data-state', song.state);
            songEl.find('.duration').text((song.data.duration / 60).toFixed(2));
            songEl.find('progress').attr('value', song.position);
            songEl.find('progress').attr('max', song.data.duration);
        }
    }, {
        key: 'updateSongPosition',
        value: function updateSongPosition(position) {
            var songEl = this.El.find('.songResult[data-state=playing]');
            songEl.find('progress').attr('value', position);
        }
    }]);

    return PlaylistController;
})();

exports.default = PlaylistController;

},{}],6:[function(require,module,exports){
'use strict';

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var SearchController = (function () {
    function SearchController(socket) {
        _classCallCheck(this, SearchController);

        this.socket = socket;
        this.dialogEl = $('#addDialog');
        this.userSetupEl = $('#user-setup');
        this.searchControlsEl = $('#search-controls');

        this.initUser();
        this.initGoogleApi(this.searchReady);
        this.initKeyEvents();
        this.initClickEvents();
    }

    _createClass(SearchController, [{
        key: 'initUser',
        value: function initUser() {
            var _this = this;

            if (localStorage.getItem('username')) {
                this.userSetupEl.hide();
                this.searchControlsEl.show();
            }
            $('#addUser').submit(function (e) {
                e.preventDefault();
                if ($('#username').val() != "") {
                    localStorage.setItem('username', $('#username').val());
                    _this.userSetupEl.hide();
                    _this.searchControlsEl.show();
                }
            });
        }
    }, {
        key: 'searchReady',
        value: function searchReady() {
            $('#search').prop('disabled', false);
        }
    }, {
        key: 'initGoogleApi',
        value: function initGoogleApi(callback) {
            setTimeout(googleApiClientReady, 1000);
            function googleApiClientReady() {
                gapi.client.setApiKey('AIzaSyC5ZNaxUE7HwOxi6r5xMq9aeRlUVdJXU7I');
                gapi.auth.init(function () {
                    gapi.client.load('youtube', 'v3', function () {
                        callback();
                    });
                });
            }
        }
    }, {
        key: 'initKeyEvents',
        value: function initKeyEvents() {
            var _this2 = this;

            $(document).keyup(function (event) {
                // Up/Down and j/k keys to navigate selecting a song
                if (event.keyCode == 40 || event.keyCode == 74) {
                    if ($('.highlight').length) {
                        var highlighted = $('.highlight');
                        highlighted.next().addClass('highlight');
                        highlighted.removeClass('highlight');
                    } else {
                        $('#search-container > .songResult:first-child').addClass('highlight');
                    }
                    return;
                }
                if (event.keyCode == 38 || event.keyCode == 75) {
                    if ($('.highlight').length) {
                        var highlighted = $('.highlight');
                        highlighted.prev().addClass('highlight');
                        highlighted.removeClass('highlight');
                    }
                    return;
                }
                // Esc closes dialog
                if (event.keyCode == 27) {
                    _this2.closeDialog();
                }
                // Run search on keydown in search box
                if ($(event.target).is('#search')) {
                    if (event.keyCode == 13 && $('.highlight').length) {
                        $('.highlight').click();
                        return;
                    }
                    _this2.search($('#search').val());
                }
                // Keys when form input isn't focused
                if (!$(event.target).is('input')) {
                    // A or Enter triggers dialog
                    if (event.keyCode == 65 || event.keyCode == 13) {
                        _this2.showDialog();
                    }
                }
            });
        }
    }, {
        key: 'search',
        value: function search(query) {
            var request = gapi.client.youtube.search.list({
                q: query,
                part: 'snippet',
                maxResults: '25'
            });

            request.execute(function (response) {
                $('#search-container').html('');
                $.each(response.result.items, function (index, item) {
                    if (item.id.kind == "youtube#video") {
                        var el = $('<div />', { 'class': 'songResult' });
                        el.data('url', item.id.videoId);
                        var image = $('<img />', { src: item.snippet.thumbnails.default.url });
                        var descWrap = $('<div />');
                        var title = $('<p />', { text: item.snippet.title, 'class': 'title' });
                        //var author = $('<p />', { text: item.snippet.channelTitle, 'class': 'description' });
                        descWrap.append(title);
                        //descWrap.append(author);
                        var imgwrap = $('<div />', { 'class': 'imageWrapper' });
                        imgwrap.append(image);
                        el.append(imgwrap);
                        el.append(descWrap);
                        $('#search-container').append(el);
                    }
                });
            });
        }
    }, {
        key: 'showDialog',
        value: function showDialog() {
            this.dialogEl.show();
            if (localStorage.getItem('username')) {
                $('#search').focus().val('');
            } else {
                $('#username').focus().val('');
            }
        }
    }, {
        key: 'closeDialog',
        value: function closeDialog() {
            this.dialogEl.hide();
        }
    }, {
        key: 'initClickEvents',
        value: function initClickEvents() {
            var _this3 = this;

            $('#addButton').click(function () {
                _this3.showDialog();
            });
            $('#addDialogClose, .overlay').click(function () {
                _this3.closeDialog();
            });
            $('#search-container').on('click', '> div', function (event) {
                var song = {
                    id: $(event.currentTarget).data('url'),
                    title: $(event.currentTarget).find('p.title').text(),
                    thumbnail: $(event.currentTarget).find('img').attr('src'),
                    username: localStorage.getItem('username')
                };
                _this3.addSongToPlaylist(song);
                $(event.currentTarget).addClass('added');
            });
        }
    }, {
        key: 'addSongToPlaylist',
        value: function addSongToPlaylist(song) {
            console.log('Adding.. ' + song.id);
            this.socket.emit('addsong', song);
        }
    }]);

    return SearchController;
})();

exports.default = SearchController;

},{}],7:[function(require,module,exports){
'use strict';

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var config = require('../config/config.js').default;

"use strict";

var SoundbitesController = (function () {
    function SoundbitesController() {
        _classCallCheck(this, SoundbitesController);

        this.buildControls();
    }

    _createClass(SoundbitesController, [{
        key: 'buildControls',
        value: function buildControls() {
            var _this = this;

            var sounds = config.soundbites.sounds;
            var container = document.createElement('div');
            container.className = 'soundbites';
            for (var id in sounds) {
                if (sounds.hasOwnProperty(id)) {
                    var youtubeId = sounds[id];
                    var element = document.createElement('div');
                    element.className = 'soundbite';
                    element.setAttribute('data-id', youtubeId);
                    element.textContent = id;
                    container.appendChild(element);
                }
            }
            document.querySelector('body').appendChild(container);
            document.addEventListener('keyup', function () {
                container.style.display = 'flex';
            });
            container.addEventListener('click', function (event) {
                if (event.target.className === 'soundbite') {
                    var _youtubeId = event.target.dataset.id;
                    _this.play(_youtubeId);
                }
            });
        }
    }, {
        key: 'play',
        value: function play(id) {
            console.log(id);
        }
    }]);

    return SoundbitesController;
})();

exports.default = SoundbitesController;

},{"../config/config.js":2}],8:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.notify = notify;
function notify(title, content) {
    if (window.Notification) {
        if (Notification.permission === "granted") {
            var notification = new Notification(title, { 'body': content, 'icon': '/favicon.ico' });
        } else {
            Notification.requestPermission(function (permission) {
                var notification = new Notification(title, { 'body': content, 'icon': '/favicon.ico' });
            });
        }
    }
}

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9zb3VyY2UvYXBwLmpzIiwianMvc291cmNlL2NvbmZpZy9jb25maWcuanMiLCJqcy9zb3VyY2UvY29uZmlnL3NvdW5kYml0ZXMuanMiLCJqcy9zb3VyY2UvY29udHJvbGxlcnMvQXBwbGljYXRpb25Db250cm9sbGVyLmpzIiwianMvc291cmNlL2NvbnRyb2xsZXJzL1BsYXlsaXN0Q29udHJvbGxlci5qcyIsImpzL3NvdXJjZS9jb250cm9sbGVycy9TZWFyY2hDb250cm9sbGVyLmpzIiwianMvc291cmNlL2NvbnRyb2xsZXJzL1NvdW5kYml0ZXNDb250cm9sbGVyLmpzIiwianMvc291cmNlL2hlbHBlcnMvbm90aWZpY2F0aW9ucy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsSUFBSSxpQkFBaUIsR0FBRyxPQUFPLENBQUMsd0NBQXdDLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDbEYsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDOztBQUUzQixJQUFJLGlCQUFpQixDQUFDLE1BQU0sQ0FBQzs7OztBQUFDLEFBSTlCLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLFlBQVc7QUFDOUIsUUFBSSxZQUFZLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQztBQUN0QyxRQUFJLGVBQWUsR0FBRyxHQUFHOztBQUFDLEFBRTFCLFFBQUcsWUFBWSxHQUFHLGVBQWUsRUFBRTtBQUMvQixTQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0tBQ3BDLE1BQ0k7QUFDRCxTQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0tBQ3ZDO0NBQ0osQ0FBQyxDQUFDOztBQUVILElBQUksT0FBTyxTQUFTLENBQUMsYUFBYSxLQUFLLFdBQVcsRUFBRTtBQUNoRCxhQUFTLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxZQUFZLEVBQUU7QUFDM0MsYUFBSyxFQUFFLEdBQUc7S0FDYixDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsR0FBRyxFQUFFO0FBQ25CLGVBQU8sQ0FBQyxHQUFHLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxDQUFDLENBQUM7S0FDakQsRUFBRSxVQUFVLEdBQUcsRUFBRTtBQUNkLGVBQU8sQ0FBQyxHQUFHLENBQUMsK0JBQStCLEVBQUUsR0FBRyxDQUFDLENBQUM7S0FDckQsQ0FBQyxDQUFDO0NBQ047Ozs7Ozs7O2tCQzNCYztBQUNYLGNBQVUsRUFBRSxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTztDQUM5Qzs7Ozs7Ozs7a0JDRmM7QUFDWCxVQUFNLEVBQUUsQ0FDSixhQUFhLEVBQ2IsYUFBYSxFQUNiLGFBQWEsQ0FDaEI7Q0FDSjs7Ozs7Ozs7Ozs7OztBQ05ELElBQUksZ0JBQWdCLEdBQUcsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQUMsT0FBTyxDQUFDO0FBQ2hFLElBQUksUUFBUSxHQUFHLE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLE9BQU8sQ0FBQztBQUMxRCxJQUFJLG9CQUFvQixHQUFHLE9BQU8sQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLE9BQU8sQ0FBQztBQUN4RSxJQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsNkJBQTZCLENBQUMsQ0FBQyxNQUFNLENBQUM7O0lBRXRDLHFCQUFxQjtBQUV0QyxhQUZpQixxQkFBcUIsQ0FFMUIsTUFBTSxFQUNsQjs4QkFIaUIscUJBQXFCOztBQUlsQyxZQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztBQUNyQixZQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztBQUNwQixZQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztBQUN4QixZQUFJLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzdCLFlBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztBQUNwQixZQUFJLG9CQUFvQixFQUFFLENBQUM7S0FDOUI7O2lCQVZnQixxQkFBcUI7O3VDQWF0Qzs7O0FBQ0ksZ0JBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxZQUFNO0FBQzVCLHVCQUFPLENBQUMsR0FBRyxDQUFDLCtCQUErQixDQUFDLENBQUM7QUFDN0MsaUJBQUMsQ0FBQyx3RkFBd0YsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQzthQUN2SCxDQUFDLENBQUM7O0FBRUgsZ0JBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxZQUFNO0FBQy9CLHVCQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQzVCLGlCQUFDLENBQUMsZ0RBQWdELENBQUMsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7YUFDNUUsQ0FBQyxDQUFDO0FBQ0gsZ0JBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxVQUFDLFlBQVksRUFBSztBQUN6QyxzQkFBSyxXQUFXLENBQUMsWUFBWSxDQUFDLENBQUM7YUFDbEMsQ0FBQyxDQUFDOztBQUVILGdCQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFZLEVBQUUsVUFBQyxJQUFJLEVBQUs7QUFDbkMsc0JBQUssV0FBVyxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQ3ZDLENBQUMsQ0FBQzs7QUFFSCxnQkFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLFVBQUMsSUFBSSxFQUFLO0FBQ2hDLHNCQUFNLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDekMsQ0FBQyxDQUFDOztBQUVILGdCQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFZLEVBQUUsVUFBQyxJQUFJLEVBQUs7QUFDbkMsb0JBQUcsSUFBSSxDQUFDLEtBQUssS0FBSyxTQUFTLEVBQUU7QUFDekIsMEJBQU0sQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUN2QywwQkFBSyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO2lCQUMxQztBQUNELHNCQUFLLFdBQVcsRUFBRSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxDQUFDO2FBQzdDLENBQUMsQ0FBQzs7QUFFSCxnQkFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsY0FBYyxFQUFFLFVBQUMsUUFBUSxFQUFLO0FBQ3pDLHNCQUFLLFdBQVcsRUFBRSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQ25ELENBQUMsQ0FBQztTQUNOOzs7MkNBRWtCOzs7QUFDZixhQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxVQUFDLENBQUMsRUFBSztBQUNsRCxvQkFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsRUFBRTtBQUN6QywyQkFBTyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQ2hDLDJCQUFPO2lCQUNWOzs7QUFBQSxBQUdELG9CQUFJLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQzs7QUFFcEQsdUJBQUssT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQ3hCLENBQUMsQ0FBQztTQUVOOzs7Z0NBRU8sTUFBTSxFQUFFO0FBQ1osbUJBQU8sQ0FBQyxHQUFHLENBQUMsa0JBQWtCLEdBQUMsTUFBTSxDQUFDLENBQUM7QUFDdkMsZ0JBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQztTQUN2Qzs7O29DQUVXLFlBQVksRUFDeEI7O0FBRUksZ0JBQUksQ0FBQyxXQUFXLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDOztBQUVyQyxnQkFBSSxDQUFDLFVBQVUsR0FBRyxZQUFZLENBQUMsRUFBRSxDQUFDO1NBQ3JDOzs7b0NBRVcsWUFBWSxFQUFFLFNBQVMsRUFDbkM7O0FBRUksZ0JBQUksU0FBUyxLQUFLLElBQUksSUFBSSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxLQUFLLFdBQVcsRUFBRTtBQUM5RSxvQkFBSSxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7YUFDaEU7U0FDSjs7O3NDQUdEO0FBQ0ksbUJBQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7U0FDMUM7Ozt5Q0FFZ0IsS0FBSyxFQUN0QjtBQUNJLGdCQUFJLEtBQUssSUFBSSxFQUFFLEVBQUU7QUFDYixpQkFBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO2FBQ3hDLE1BQU07QUFDSCxpQkFBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsc0JBQXNCLENBQUMsQ0FBQzthQUNuRDtTQUNKOzs7V0FoR2dCLHFCQUFxQjs7O2tCQUFyQixxQkFBcUI7Ozs7Ozs7Ozs7Ozs7SUNMckIsa0JBQWtCO0FBRW5DLGFBRmlCLGtCQUFrQixDQUV2QixZQUFZLEVBQUU7OEJBRlQsa0JBQWtCOztBQUcvQixZQUFJLENBQUMsRUFBRSxHQUFHLFlBQVksQ0FBQyxFQUFFLENBQUM7QUFDMUIsWUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDaEIsWUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUNoQyxZQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO0tBQzVCOztpQkFQZ0Isa0JBQWtCOzs4QkFTN0IsWUFBWSxFQUNsQjs7QUFFSSxnQkFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7O0FBRWpCLGFBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssRUFBRSxDQUFBLFVBQVMsS0FBSyxFQUFFLElBQUksRUFBRTs7QUFFN0Msb0JBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7YUFFdEIsQ0FBQSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1NBQ2pCOzs7a0NBRVMsSUFBSSxFQUNkO0FBQ0ksZ0JBQUksSUFBSSxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRSxPQUFPLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRSxPQUFPLEdBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxZQUFZLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUM7O0FBRXBHLGdCQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsU0FBUyxFQUFFLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDO0FBQ2xELGdCQUFJLFFBQVEsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUEsQ0FBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQy9GLGdCQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDO0FBQ3BFLGdCQUFJLFFBQVEsR0FBRyxDQUFDLENBQUMsY0FBYyxFQUFFLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztBQUNwRixnQkFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDOztBQUV4RSxnQkFBSSxPQUFPLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRSxFQUFFLE9BQU8sRUFBRSxjQUFjLEVBQUUsQ0FBQyxDQUFDO0FBQ3hELGdCQUFJLFdBQVcsR0FBRyxDQUFDLENBQUMsU0FBUyxFQUFFLEVBQUUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLENBQUMsQ0FBQzs7QUFFOUQsbUJBQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdEIsdUJBQVcsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDMUIsdUJBQVcsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDN0IsZ0JBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDckIsZ0JBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDekIsZ0JBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDdEIsZ0JBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7O0FBRXRCLG1CQUFPLElBQUksQ0FBQztTQUNmOzs7bUNBRVUsWUFBWSxFQUN2QjtBQUNJLGdCQUFJLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDOztBQUVwRCxpQkFBSyxJQUFJLENBQUMsR0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQ3BDLG9CQUFJLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDOztBQUV6QixvQkFBRyxJQUFJLENBQUMsRUFBRSxLQUFLLFlBQVksQ0FBQyxFQUFFLEVBQUU7QUFDNUIsd0JBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQztBQUN2QiwwQkFBTTtpQkFDVDthQUNKO1NBQ0o7OztnQ0FFTyxJQUFJLEVBQ1o7QUFDSSxnQkFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1NBQ3hDOzs7eUNBRWdCLElBQUksRUFDckI7QUFDSSxnQkFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ3pELGtCQUFNLENBQUMsSUFBSSxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdEMsa0JBQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFBLENBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDcEUsa0JBQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDckQsa0JBQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQzNEOzs7MkNBRWtCLFFBQVEsRUFDM0I7QUFDSSxnQkFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsaUNBQWlDLENBQUMsQ0FBQztBQUM3RCxrQkFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1NBQ25EOzs7V0E3RWdCLGtCQUFrQjs7O2tCQUFsQixrQkFBa0I7Ozs7Ozs7Ozs7Ozs7SUNBbEIsZ0JBQWdCO0FBRWpDLGFBRmlCLGdCQUFnQixDQUVyQixNQUFNLEVBQUU7OEJBRkgsZ0JBQWdCOztBQUc3QixZQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztBQUNyQixZQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUNoQyxZQUFJLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUNwQyxZQUFJLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUM7O0FBRTlDLFlBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztBQUNoQixZQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUNyQyxZQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7QUFDckIsWUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO0tBQzFCOztpQkFaZ0IsZ0JBQWdCOzttQ0FlakM7OztBQUNJLGdCQUFHLFlBQVksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUU7QUFDakMsb0JBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDeEIsb0JBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQzthQUNoQztBQUNELGFBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBQyxDQUFDLEVBQUs7QUFDeEIsaUJBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztBQUNuQixvQkFBSSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFO0FBQzVCLGdDQUFZLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztBQUN2RCwwQkFBSyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDeEIsMEJBQUssZ0JBQWdCLENBQUMsSUFBSSxFQUFFLENBQUM7aUJBQ2hDO2FBQ0osQ0FBQyxDQUFDO1NBQ047OztzQ0FHRDtBQUNJLGFBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQ3hDOzs7c0NBRWEsUUFBUSxFQUN0QjtBQUNJLHNCQUFVLENBQUMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDdkMscUJBQVMsb0JBQW9CLEdBQUc7QUFDNUIsb0JBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLHlDQUF5QyxDQUFDLENBQUM7QUFDakUsb0JBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVc7QUFDdEIsd0JBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsWUFBWTtBQUMxQyxnQ0FBUSxFQUFFLENBQUM7cUJBQ2QsQ0FBQyxDQUFDO2lCQUNOLENBQUMsQ0FBQzthQUNOO1NBQ0o7Ozt3Q0FFZTs7O0FBQ1osYUFBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFDLEtBQUssRUFBSzs7QUFFekIsb0JBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxFQUFFLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxFQUFFLEVBQUU7QUFDNUMsd0JBQUksQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLE1BQU0sRUFBRTtBQUN4Qiw0QkFBSSxXQUFXLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ2xDLG1DQUFXLENBQUMsSUFBSSxFQUFFLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQ3pDLG1DQUFXLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDO3FCQUN4QyxNQUFNO0FBQ0gseUJBQUMsQ0FBQyw2Q0FBNkMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQztxQkFDMUU7QUFDRCwyQkFBTztpQkFDVjtBQUNELG9CQUFJLEtBQUssQ0FBQyxPQUFPLElBQUksRUFBRSxJQUFJLEtBQUssQ0FBQyxPQUFPLElBQUksRUFBRSxFQUFFO0FBQzVDLHdCQUFJLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxNQUFNLEVBQUU7QUFDeEIsNEJBQUksV0FBVyxHQUFHLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUNsQyxtQ0FBVyxDQUFDLElBQUksRUFBRSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUN6QyxtQ0FBVyxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsQ0FBQztxQkFDeEM7QUFDRCwyQkFBTztpQkFDVjs7QUFBQSxBQUVELG9CQUFJLEtBQUssQ0FBQyxPQUFPLElBQUksRUFBRSxFQUFFO0FBQ3JCLDJCQUFLLFdBQVcsRUFBRSxDQUFDO2lCQUN0Qjs7QUFBQSxBQUVELG9CQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxFQUFFO0FBQy9CLHdCQUFJLEtBQUssQ0FBQyxPQUFPLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxNQUFNLEVBQUU7QUFDL0MseUJBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUN4QiwrQkFBTztxQkFDVjtBQUNELDJCQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztpQkFDbkM7O0FBQUEsQUFFRCxvQkFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxFQUFFOztBQUU5Qix3QkFBSSxLQUFLLENBQUMsT0FBTyxJQUFJLEVBQUUsSUFBSSxLQUFLLENBQUMsT0FBTyxJQUFJLEVBQUUsRUFBRTtBQUM1QywrQkFBSyxVQUFVLEVBQUUsQ0FBQztxQkFDckI7aUJBQ0o7YUFDSixDQUFDLENBQUM7U0FDTjs7OytCQUVNLEtBQUssRUFDWjtBQUNJLGdCQUFJLE9BQU8sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDO0FBQzFDLGlCQUFDLEVBQUUsS0FBSztBQUNSLG9CQUFJLEVBQUUsU0FBUztBQUNmLDBCQUFVLEVBQUUsSUFBSTthQUNuQixDQUFDLENBQUM7O0FBRUgsbUJBQU8sQ0FBQyxPQUFPLENBQUMsVUFBQyxRQUFRLEVBQUs7QUFDMUIsaUJBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNoQyxpQkFBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxVQUFVLEtBQUssRUFBRSxJQUFJLEVBQUU7QUFDakQsd0JBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLElBQUksZUFBZSxFQUFFO0FBQ2pDLDRCQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsU0FBUyxFQUFFLEVBQUMsT0FBTyxFQUFFLFlBQVksRUFBQyxDQUFDLENBQUM7QUFDL0MsMEJBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDaEMsNEJBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBQyxDQUFDLENBQUM7QUFDckUsNEJBQUksUUFBUSxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUM1Qiw0QkFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFDLElBQUksRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFDLENBQUM7O0FBQUMsQUFFckUsZ0NBQVEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDOztBQUFDLEFBRXZCLDRCQUFJLE9BQU8sR0FBRyxDQUFDLENBQUMsU0FBUyxFQUFFLEVBQUMsT0FBTyxFQUFFLGNBQWMsRUFBQyxDQUFDLENBQUM7QUFDdEQsK0JBQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdEIsMEJBQUUsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDbkIsMEJBQUUsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDcEIseUJBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztxQkFDckM7aUJBQ0osQ0FBQyxDQUFBO2FBQ0wsQ0FBQyxDQUFDO1NBQ047OztxQ0FFWTtBQUNULGdCQUFJLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ3JCLGdCQUFJLFlBQVksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUU7QUFDbEMsaUJBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7YUFDaEMsTUFBTTtBQUNILGlCQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2FBQ2xDO1NBQ0o7OztzQ0FHRDtBQUNJLGdCQUFJLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1NBQ3hCOzs7MENBR0Q7OztBQUNJLGFBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxLQUFLLENBQUMsWUFBTTtBQUN4Qix1QkFBSyxVQUFVLEVBQUUsQ0FBQzthQUNyQixDQUFDLENBQUM7QUFDSCxhQUFDLENBQUMsMkJBQTJCLENBQUMsQ0FBQyxLQUFLLENBQUMsWUFBTTtBQUN2Qyx1QkFBSyxXQUFXLEVBQUUsQ0FBQzthQUN0QixDQUFDLENBQUM7QUFDSCxhQUFDLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxVQUFDLEtBQUssRUFBSztBQUNuRCxvQkFBSSxJQUFJLEdBQUc7QUFDUCxzQkFBRSxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztBQUN0Qyx5QkFBSyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksRUFBRTtBQUNwRCw2QkFBUyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7QUFDekQsNEJBQVEsRUFBRSxZQUFZLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztpQkFDN0MsQ0FBQztBQUNGLHVCQUFLLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO0FBQzdCLGlCQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQzthQUM1QyxDQUFDLENBQUM7U0FFTjs7OzBDQUVpQixJQUFJLEVBQ3RCO0FBQ0ksbUJBQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNuQyxnQkFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1NBQ3JDOzs7V0FoS2dCLGdCQUFnQjs7O2tCQUFoQixnQkFBZ0I7Ozs7Ozs7Ozs7Ozs7QUNBckMsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLHFCQUFxQixDQUFDLENBQUMsT0FBTyxDQUFDOztBQUVwRCxZQUFZLENBQUM7O0lBRVEsb0JBQW9CO0FBR3JDLGFBSGlCLG9CQUFvQixHQUlyQzs4QkFKaUIsb0JBQW9COztBQUtqQyxZQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7S0FDeEI7O2lCQU5nQixvQkFBb0I7O3dDQVNyQzs7O0FBQ0ksZ0JBQUksTUFBTSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDO0FBQ3RDLGdCQUFJLFNBQVMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzlDLHFCQUFTLENBQUMsU0FBUyxHQUFHLFlBQVksQ0FBQztBQUNuQyxpQkFBSyxJQUFJLEVBQUUsSUFBSSxNQUFNLEVBQUU7QUFDbkIsb0JBQUksTUFBTSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUMsRUFBRTtBQUMzQix3QkFBSSxTQUFTLEdBQUcsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQzNCLHdCQUFJLE9BQU8sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzVDLDJCQUFPLENBQUMsU0FBUyxHQUFHLFdBQVcsQ0FBQztBQUNoQywyQkFBTyxDQUFDLFlBQVksQ0FBQyxTQUFTLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDM0MsMkJBQU8sQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO0FBQ3pCLDZCQUFTLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO2lCQUNsQzthQUNKO0FBQ0Qsb0JBQVEsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3RELG9CQUFRLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFlBQU07QUFDckMseUJBQVMsQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQzthQUNwQyxDQUFDLENBQUM7QUFDSCxxQkFBUyxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxVQUFDLEtBQUssRUFBSztBQUMzQyxvQkFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLFNBQVMsS0FBSyxXQUFXLEVBQUU7QUFDeEMsd0JBQUksVUFBUyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztBQUN4QywwQkFBSyxJQUFJLENBQUMsVUFBUyxDQUFDLENBQUM7aUJBQ3hCO2FBQ0osQ0FBQyxDQUFDO1NBQ047Ozs2QkFFSSxFQUFFLEVBQ1A7QUFDSSxtQkFBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUNuQjs7O1dBdENnQixvQkFBb0I7OztrQkFBcEIsb0JBQW9COzs7Ozs7OztRQ0p6QixNQUFNLEdBQU4sTUFBTTtBQUFmLFNBQVMsTUFBTSxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUU7QUFDbkMsUUFBSSxNQUFNLENBQUMsWUFBWSxFQUFFO0FBQ3JCLFlBQUksWUFBWSxDQUFDLFVBQVUsS0FBSyxTQUFTLEVBQUU7QUFDdkMsZ0JBQUksWUFBWSxHQUFHLElBQUksWUFBWSxDQUFDLEtBQUssRUFBRSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLGNBQWMsRUFBRSxDQUFDLENBQUM7U0FDM0YsTUFBTTtBQUNILHdCQUFZLENBQUMsaUJBQWlCLENBQUMsVUFBUyxVQUFVLEVBQUU7QUFDaEQsb0JBQUksWUFBWSxHQUFHLElBQUksWUFBWSxDQUFDLEtBQUssRUFBRSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLGNBQWMsRUFBRSxDQUFDLENBQUM7YUFDM0YsQ0FBQyxDQUFDO1NBQ047S0FDSjtDQUNKIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBKdWtlYm94Q29udHJvbGxlciA9IHJlcXVpcmUoXCIuL2NvbnRyb2xsZXJzL0FwcGxpY2F0aW9uQ29udHJvbGxlci5qc1wiKS5kZWZhdWx0O1xudmFyIHNvY2tldCA9IGlvKCcvLzozMDAwJyk7XG5cbm5ldyBKdWtlYm94Q29udHJvbGxlcihzb2NrZXQpO1xuXG4vLyAtLS0tXG5cbiQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG4gICAgdmFyIHlfc2Nyb2xsX3BvcyA9IHdpbmRvdy5wYWdlWU9mZnNldDtcbiAgICB2YXIgc2Nyb2xsX3Bvc190ZXN0ID0gMTIwOyAgICAgICAgICAgICAvLyBzZXQgdG8gd2hhdGV2ZXIgeW91IHdhbnQgaXQgdG8gYmVcblxuICAgIGlmKHlfc2Nyb2xsX3BvcyA+IHNjcm9sbF9wb3NfdGVzdCkge1xuICAgICAgICAkKCdoZWFkZXInKS5hZGRDbGFzcygnc2Nyb2xsZWQnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgICQoJ2hlYWRlcicpLnJlbW92ZUNsYXNzKCdzY3JvbGxlZCcpO1xuICAgIH1cbn0pO1xuXG5pZiAodHlwZW9mIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyICE9PSAndW5kZWZpbmVkJykge1xuICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCcvd29ya2VyLmpzJywge1xuICAgICAgICBzY29wZTogJy8nXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzZXJ2aWNlIHdvcmtlciByZWdpc3RlcmVkJywgcmVnKTtcbiAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzZXJ2aWNlIHdvcmtlciBOT1QgcmVnaXN0ZXJlZCcsIGVycik7XG4gICAgfSk7XG59IiwiZXhwb3J0IGRlZmF1bHQge1xuICAgIHNvdW5kYml0ZXM6IHJlcXVpcmUoJy4vc291bmRiaXRlcycpLmRlZmF1bHRcbn07IiwiZXhwb3J0IGRlZmF1bHQge1xuICAgIHNvdW5kczogW1xuICAgICAgICAnWUxnS1BFaHlnM2snLFxuICAgICAgICAnY2RFUW1wVklFNEEnLFxuICAgICAgICAna0RfeFdyaFo4eUknXG4gICAgXVxufTsiLCJ2YXIgU2VhcmNoQ29udHJvbGxlciA9IHJlcXVpcmUoXCIuL1NlYXJjaENvbnRyb2xsZXIuanNcIikuZGVmYXVsdDtcbnZhciBQbGF5bGlzdCA9IHJlcXVpcmUoXCIuL1BsYXlsaXN0Q29udHJvbGxlci5qc1wiKS5kZWZhdWx0O1xubGV0IFNvdW5kYml0ZXNDb250cm9sbGVyID0gcmVxdWlyZShcIi4vU291bmRiaXRlc0NvbnRyb2xsZXIuanNcIikuZGVmYXVsdDtcbnZhciBub3RpZnkgPSByZXF1aXJlKFwiLi4vaGVscGVycy9ub3RpZmljYXRpb25zLmpzXCIpLm5vdGlmeTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBwbGljYXRpb25Db250cm9sbGVyXG57XG4gICAgY29uc3RydWN0b3Ioc29ja2V0KVxuICAgIHtcbiAgICAgICAgdGhpcy5zb2NrZXQgPSBzb2NrZXQ7XG4gICAgICAgIHRoaXMucGxheWxpc3RzID0ge307XG4gICAgICAgIHRoaXMuc2V0RXZlbnRIYW5kbGVycygpO1xuICAgICAgICBuZXcgU2VhcmNoQ29udHJvbGxlcihzb2NrZXQpO1xuICAgICAgICB0aGlzLnNldHVwU29ja2V0cygpO1xuICAgICAgICBuZXcgU291bmRiaXRlc0NvbnRyb2xsZXIoKTtcbiAgICB9XG5cbiAgICBzZXR1cFNvY2tldHMoKVxuICAgIHtcbiAgICAgICAgdGhpcy5zb2NrZXQub24oJ2Nvbm5lY3QnLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY29ubmVjdGVkIHRvIHdlYnNvY2tldCBzZXJ2ZXInKTtcbiAgICAgICAgICAgICQoJyNwbGF5QnV0dG9uLCAjcGF1c2VCdXR0b24sICN2b2x1cEJ1dHRvbiwgI3ZvbGRvd25CdXR0b24sICNzaHVmZmxlU29uZ3MsICNmb3J3YXJkQnV0dG9uJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc29ja2V0Lm9uKCdkaXNjb25uZWN0JywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Rpc2Nvbm5lY3RlZCcpO1xuICAgICAgICAgICAgJCgnLm1lZGlhLWNvbnRyb2xzIC5idG4sICNzaHV0ZG93biwgI3NodWZmbGVTb25ncycpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zb2NrZXQub24oJ3BsYXlsaXN0JywgKHBsYXlsaXN0RGF0YSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRQbGF5bGlzdChwbGF5bGlzdERhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnNvY2tldC5vbignc29uZ1JlbW92ZScsIChzb25nKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmdldFBsYXlsaXN0KCkucmVtb3ZlU29uZyhzb25nKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zb2NrZXQub24oJ3NvbmdBZGQnLCAoc29uZykgPT4ge1xuICAgICAgICAgICAgbm90aWZ5KCdTb25nIEFkZGVkJywgc29uZy5kYXRhLnRpdGxlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zb2NrZXQub24oJ3NvbmdTdGF0dXMnLCAoc29uZykgPT4ge1xuICAgICAgICAgICAgaWYoc29uZy5zdGF0ZSA9PT0gJ3BsYXlpbmcnKSB7XG4gICAgICAgICAgICAgICAgbm90aWZ5KCdOb3cgUGxheWluZycsIHNvbmcuZGF0YS50aXRsZSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVOb3dQbGF5aW5nKHNvbmcuZGF0YS50aXRsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmdldFBsYXlsaXN0KCkudXBkYXRlU29uZ1N0YXR1cyhzb25nKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zb2NrZXQub24oJ3NvbmdQb3NpdGlvbicsIChwb3NpdGlvbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5nZXRQbGF5bGlzdCgpLnVwZGF0ZVNvbmdQb3NpdGlvbihwb3NpdGlvbik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNldEV2ZW50SGFuZGxlcnMoKSB7XG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdidXR0b25bZGF0YS1hY3Rpb25dJywgKGUpID0+IHtcbiAgICAgICAgICAgIGlmICgkKGUuY3VycmVudFRhcmdldCkuaGFzQ2xhc3MoJ2Rpc2FibGVkJykpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0J1dHRvbiBkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2V0IHRoZSBhY3Rpb24gdG8gc2VuZFxuICAgICAgICAgICAgdmFyIGFjdGlvbiA9ICQoZS5jdXJyZW50VGFyZ2V0KS5hdHRyKCdkYXRhLWFjdGlvbicpO1xuXG4gICAgICAgICAgICB0aGlzLmNvbnRyb2woYWN0aW9uKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICBjb250cm9sKGFjdGlvbikge1xuICAgICAgICBjb25zb2xlLmxvZygnU2VuZGluZyBhY3Rpb246ICcrYWN0aW9uKTtcbiAgICAgICAgdGhpcy5zb2NrZXQuZW1pdCgnY29udHJvbCcsIGFjdGlvbik7XG4gICAgfVxuXG4gICAgc2V0UGxheWxpc3QocGxheWxpc3REYXRhKVxuICAgIHtcbiAgICAgICAgLy8gVHJ5IGFuZCBhZGQgdGhpcyBwbGF5bGlzdFxuICAgICAgICB0aGlzLmFkZFBsYXlsaXN0KHBsYXlsaXN0RGF0YSwgdHJ1ZSk7XG5cbiAgICAgICAgdGhpcy5wbGF5bGlzdElEID0gcGxheWxpc3REYXRhLklEO1xuICAgIH1cblxuICAgIGFkZFBsYXlsaXN0KHBsYXlsaXN0RGF0YSwgb3ZlcndyaXRlKVxuICAgIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBhbHJlYWR5IGxvYWRlZCB0aGlzIHBsYXlsaXN0XG4gICAgICAgIGlmIChvdmVyd3JpdGUgPT09IHRydWUgfHwgdHlwZW9mIHRoaXMucGxheWxpc3RzW3BsYXlsaXN0RGF0YS5JRF0gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aGlzLnBsYXlsaXN0c1twbGF5bGlzdERhdGEuSURdID0gbmV3IFBsYXlsaXN0KHBsYXlsaXN0RGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRQbGF5bGlzdCgpXG4gICAge1xuICAgICAgICByZXR1cm4gdGhpcy5wbGF5bGlzdHNbdGhpcy5wbGF5bGlzdElEXTtcbiAgICB9XG5cbiAgICB1cGRhdGVOb3dQbGF5aW5nKHRpdGxlKVxuICAgIHtcbiAgICAgICAgaWYgKHRpdGxlID09ICcnKSB7XG4gICAgICAgICAgICAkKCd0aXRsZScpLnRleHQoJ0ZyZXNobGVhZiBKdWtlYm94Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKCd0aXRsZScpLnRleHQodGl0bGUgKyAnIC0gRnJlc2hsZWFmIEp1a2Vib3gnKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQbGF5bGlzdENvbnRyb2xsZXIge1xuXG4gICAgY29uc3RydWN0b3IocGxheWxpc3REYXRhKSB7XG4gICAgICAgIHRoaXMuSUQgPSBwbGF5bGlzdERhdGEuSUQ7XG4gICAgICAgIHRoaXMuc29uZ3MgPSBbXTtcbiAgICAgICAgdGhpcy5FbCA9ICQoJy5xdWV1ZS1jb250YWluZXInKTtcbiAgICAgICAgdGhpcy5idWlsZChwbGF5bGlzdERhdGEpO1xuICAgIH1cblxuICAgIGJ1aWxkKHBsYXlsaXN0RGF0YSlcbiAgICB7XG4gICAgICAgIC8vQ2xlYXIgdGhlIGN1cnJlbnQgcGxheWxpc3RcbiAgICAgICAgdGhpcy5FbC5odG1sKCcnKTtcblxuICAgICAgICAkLmVhY2gocGxheWxpc3REYXRhLnNvbmdzLCBmdW5jdGlvbihpbmRleCwgc29uZykge1xuXG4gICAgICAgICAgICB0aGlzLmFkZFNvbmcoc29uZyk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBidWlsZFNvbmcoc29uZylcbiAgICB7XG4gICAgICAgIHZhciBpdGVtID0gJCgnPGRpdiAvPicsIHsgJ2NsYXNzJzogJ3NvbmdSZXN1bHQnLCAnaWQnOiAnc29uZy0nK3NvbmcuaWQsICdkYXRhLXN0YXRlJzogc29uZy5zdGF0ZSB9KTtcblxuICAgICAgICB2YXIgaW1hZ2UgPSAkKCc8aW1nIC8+JywgeyBzcmM6IHNvbmcudGh1bWJuYWlsIH0pO1xuICAgICAgICB2YXIgZHVyYXRpb24gPSAkKCc8cCAvPicsIHsgJ2NsYXNzJzogJ2R1cmF0aW9uJywgdGV4dDogKHNvbmcuZGF0YS5kdXJhdGlvbiAvIDYwKS50b0ZpeGVkKDIpIH0pO1xuICAgICAgICB2YXIgdGl0bGUgPSAkKCc8cCAvPicsIHsgJ2NsYXNzJzogJ3RpdGxlJywgdGV4dDogc29uZy5kYXRhLnRpdGxlIH0pO1xuICAgICAgICB2YXIgcHJvZ3Jlc3MgPSAkKCc8cHJvZ3Jlc3MgLz4nLCB7IHZhbHVlOiBzb25nLnBvc2l0aW9uLCBtYXg6IHNvbmcuZGF0YS5kdXJhdGlvbiB9KTtcbiAgICAgICAgdmFyIHVzZXJuYW1lID0gJCgnPHAgLz4nLCB7ICdjbGFzcyc6ICd1c2VybmFtZScsIHRleHQ6IHNvbmcudXNlcm5hbWUgfSk7XG5cbiAgICAgICAgdmFyIGltZ3dyYXAgPSAkKCc8ZGl2IC8+JywgeyAnY2xhc3MnOiAnaW1hZ2VXcmFwcGVyJyB9KTtcbiAgICAgICAgdmFyIGNvbnRlbnR3cmFwID0gJCgnPGRpdiAvPicsIHsgJ2NsYXNzJzogJ2NvbnRlbnRXcmFwcGVyJyB9KTtcblxuICAgICAgICBpbWd3cmFwLmFwcGVuZChpbWFnZSk7XG4gICAgICAgIGNvbnRlbnR3cmFwLmFwcGVuZCh0aXRsZSk7XG4gICAgICAgIGNvbnRlbnR3cmFwLmFwcGVuZChwcm9ncmVzcyk7XG4gICAgICAgIGl0ZW0uYXBwZW5kKGltZ3dyYXApO1xuICAgICAgICBpdGVtLmFwcGVuZChjb250ZW50d3JhcCk7XG4gICAgICAgIGl0ZW0uYXBwZW5kKHVzZXJuYW1lKTtcbiAgICAgICAgaXRlbS5hcHBlbmQoZHVyYXRpb24pO1xuXG4gICAgICAgIHJldHVybiBpdGVtO1xuICAgIH1cblxuICAgIHJlbW92ZVNvbmcoc29uZ1RvUmVtb3ZlKVxuICAgIHtcbiAgICAgICAgdGhpcy5FbC5jaGlsZHJlbignI3NvbmctJytzb25nVG9SZW1vdmUuaWQpLnJlbW92ZSgpO1xuXG4gICAgICAgIGZvciAodmFyIGk9MDsgaTx0aGlzLnNvbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc29uZyA9IHRoaXMuc29uZ3NbaV07XG5cbiAgICAgICAgICAgIGlmKHNvbmcuaWQgPT09IHNvbmdUb1JlbW92ZS5pZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc29uZ3Muc3BsaWNlKGksMSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhZGRTb25nKHNvbmcpXG4gICAge1xuICAgICAgICB0aGlzLkVsLmFwcGVuZCh0aGlzLmJ1aWxkU29uZyhzb25nKSk7XG4gICAgfVxuXG4gICAgdXBkYXRlU29uZ1N0YXR1cyhzb25nKVxuICAgIHtcbiAgICAgICAgdmFyIHNvbmdFbCA9IHRoaXMuRWwuZmluZCgnLnNvbmdSZXN1bHQjc29uZy0nICsgc29uZy5pZCk7XG4gICAgICAgIHNvbmdFbC5hdHRyKCdkYXRhLXN0YXRlJywgc29uZy5zdGF0ZSk7XG4gICAgICAgIHNvbmdFbC5maW5kKCcuZHVyYXRpb24nKS50ZXh0KChzb25nLmRhdGEuZHVyYXRpb24gLyA2MCkudG9GaXhlZCgyKSk7XG4gICAgICAgIHNvbmdFbC5maW5kKCdwcm9ncmVzcycpLmF0dHIoJ3ZhbHVlJywgc29uZy5wb3NpdGlvbik7XG4gICAgICAgIHNvbmdFbC5maW5kKCdwcm9ncmVzcycpLmF0dHIoJ21heCcsIHNvbmcuZGF0YS5kdXJhdGlvbik7XG4gICAgfVxuXG4gICAgdXBkYXRlU29uZ1Bvc2l0aW9uKHBvc2l0aW9uKVxuICAgIHtcbiAgICAgICAgdmFyIHNvbmdFbCA9IHRoaXMuRWwuZmluZCgnLnNvbmdSZXN1bHRbZGF0YS1zdGF0ZT1wbGF5aW5nXScpO1xuICAgICAgICBzb25nRWwuZmluZCgncHJvZ3Jlc3MnKS5hdHRyKCd2YWx1ZScsIHBvc2l0aW9uKTtcbiAgICB9XG59XG5cblxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWFyY2hDb250cm9sbGVyXG57XG4gICAgY29uc3RydWN0b3Ioc29ja2V0KSB7XG4gICAgICAgIHRoaXMuc29ja2V0ID0gc29ja2V0O1xuICAgICAgICB0aGlzLmRpYWxvZ0VsID0gJCgnI2FkZERpYWxvZycpO1xuICAgICAgICB0aGlzLnVzZXJTZXR1cEVsID0gJCgnI3VzZXItc2V0dXAnKTtcbiAgICAgICAgdGhpcy5zZWFyY2hDb250cm9sc0VsID0gJCgnI3NlYXJjaC1jb250cm9scycpO1xuXG4gICAgICAgIHRoaXMuaW5pdFVzZXIoKTtcbiAgICAgICAgdGhpcy5pbml0R29vZ2xlQXBpKHRoaXMuc2VhcmNoUmVhZHkpO1xuICAgICAgICB0aGlzLmluaXRLZXlFdmVudHMoKTtcbiAgICAgICAgdGhpcy5pbml0Q2xpY2tFdmVudHMoKTtcbiAgICB9XG5cbiAgICBpbml0VXNlcigpXG4gICAge1xuICAgICAgICBpZihsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcm5hbWUnKSkge1xuICAgICAgICAgICAgdGhpcy51c2VyU2V0dXBFbC5oaWRlKCk7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaENvbnRyb2xzRWwuc2hvdygpO1xuICAgICAgICB9XG4gICAgICAgICQoJyNhZGRVc2VyJykuc3VibWl0KChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBpZiAoJCgnI3VzZXJuYW1lJykudmFsKCkgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VybmFtZScsICQoJyN1c2VybmFtZScpLnZhbCgpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZXJTZXR1cEVsLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaENvbnRyb2xzRWwuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZWFyY2hSZWFkeSgpXG4gICAge1xuICAgICAgICAkKCcjc2VhcmNoJykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgaW5pdEdvb2dsZUFwaShjYWxsYmFjaylcbiAgICB7XG4gICAgICAgIHNldFRpbWVvdXQoZ29vZ2xlQXBpQ2xpZW50UmVhZHksIDEwMDApO1xuICAgICAgICBmdW5jdGlvbiBnb29nbGVBcGlDbGllbnRSZWFkeSgpIHtcbiAgICAgICAgICAgIGdhcGkuY2xpZW50LnNldEFwaUtleSgnQUl6YVN5QzVaTmF4VUU3SHdPeGk2cjV4TXE5YWVSbFVWZEpYVTdJJyk7XG4gICAgICAgICAgICBnYXBpLmF1dGguaW5pdChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBnYXBpLmNsaWVudC5sb2FkKCd5b3V0dWJlJywgJ3YzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpbml0S2V5RXZlbnRzKCkge1xuICAgICAgICAkKGRvY3VtZW50KS5rZXl1cCgoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vIFVwL0Rvd24gYW5kIGovayBrZXlzIHRvIG5hdmlnYXRlIHNlbGVjdGluZyBhIHNvbmdcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09IDQwIHx8IGV2ZW50LmtleUNvZGUgPT0gNzQpIHtcbiAgICAgICAgICAgICAgICBpZiAoJCgnLmhpZ2hsaWdodCcpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGlnaGxpZ2h0ZWQgPSAkKCcuaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkLm5leHQoKS5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkKCcjc2VhcmNoLWNvbnRhaW5lciA+IC5zb25nUmVzdWx0OmZpcnN0LWNoaWxkJykuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAzOCB8fCBldmVudC5rZXlDb2RlID09IDc1KSB7XG4gICAgICAgICAgICAgICAgaWYgKCQoJy5oaWdobGlnaHQnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhpZ2hsaWdodGVkID0gJCgnLmhpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRlZC5wcmV2KCkuYWRkQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRlZC5yZW1vdmVDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEVzYyBjbG9zZXMgZGlhbG9nXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAyNykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFJ1biBzZWFyY2ggb24ga2V5ZG93biBpbiBzZWFyY2ggYm94XG4gICAgICAgICAgICBpZiAoJChldmVudC50YXJnZXQpLmlzKCcjc2VhcmNoJykpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAxMyAmJiAkKCcuaGlnaGxpZ2h0JykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJy5oaWdobGlnaHQnKS5jbGljaygpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoKCQoJyNzZWFyY2gnKS52YWwoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBLZXlzIHdoZW4gZm9ybSBpbnB1dCBpc24ndCBmb2N1c2VkXG4gICAgICAgICAgICBpZiAoISQoZXZlbnQudGFyZ2V0KS5pcygnaW5wdXQnKSkge1xuICAgICAgICAgICAgICAgIC8vIEEgb3IgRW50ZXIgdHJpZ2dlcnMgZGlhbG9nXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gNjUgfHwgZXZlbnQua2V5Q29kZSA9PSAxMykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dEaWFsb2coKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNlYXJjaChxdWVyeSlcbiAgICB7XG4gICAgICAgIHZhciByZXF1ZXN0ID0gZ2FwaS5jbGllbnQueW91dHViZS5zZWFyY2gubGlzdCh7XG4gICAgICAgICAgICBxOiBxdWVyeSxcbiAgICAgICAgICAgIHBhcnQ6ICdzbmlwcGV0JyxcbiAgICAgICAgICAgIG1heFJlc3VsdHM6ICcyNSdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmVxdWVzdC5leGVjdXRlKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgJCgnI3NlYXJjaC1jb250YWluZXInKS5odG1sKCcnKTtcbiAgICAgICAgICAgICQuZWFjaChyZXNwb25zZS5yZXN1bHQuaXRlbXMsIGZ1bmN0aW9uIChpbmRleCwgaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChpdGVtLmlkLmtpbmQgPT0gXCJ5b3V0dWJlI3ZpZGVvXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsID0gJCgnPGRpdiAvPicsIHsnY2xhc3MnOiAnc29uZ1Jlc3VsdCd9KTtcbiAgICAgICAgICAgICAgICAgICAgZWwuZGF0YSgndXJsJywgaXRlbS5pZC52aWRlb0lkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlID0gJCgnPGltZyAvPicsIHtzcmM6IGl0ZW0uc25pcHBldC50aHVtYm5haWxzLmRlZmF1bHQudXJsfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXNjV3JhcCA9ICQoJzxkaXYgLz4nKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gJCgnPHAgLz4nLCB7dGV4dDogaXRlbS5zbmlwcGV0LnRpdGxlLCAnY2xhc3MnOiAndGl0bGUnfSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdmFyIGF1dGhvciA9ICQoJzxwIC8+JywgeyB0ZXh0OiBpdGVtLnNuaXBwZXQuY2hhbm5lbFRpdGxlLCAnY2xhc3MnOiAnZGVzY3JpcHRpb24nIH0pO1xuICAgICAgICAgICAgICAgICAgICBkZXNjV3JhcC5hcHBlbmQodGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAvL2Rlc2NXcmFwLmFwcGVuZChhdXRob3IpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW1nd3JhcCA9ICQoJzxkaXYgLz4nLCB7J2NsYXNzJzogJ2ltYWdlV3JhcHBlcid9KTtcbiAgICAgICAgICAgICAgICAgICAgaW1nd3JhcC5hcHBlbmQoaW1hZ2UpO1xuICAgICAgICAgICAgICAgICAgICBlbC5hcHBlbmQoaW1nd3JhcCk7XG4gICAgICAgICAgICAgICAgICAgIGVsLmFwcGVuZChkZXNjV3JhcCk7XG4gICAgICAgICAgICAgICAgICAgICQoJyNzZWFyY2gtY29udGFpbmVyJykuYXBwZW5kKGVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzaG93RGlhbG9nKCkge1xuICAgICAgICB0aGlzLmRpYWxvZ0VsLnNob3coKTtcbiAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VybmFtZScpKSB7XG4gICAgICAgICAgICAkKCcjc2VhcmNoJykuZm9jdXMoKS52YWwoJycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJCgnI3VzZXJuYW1lJykuZm9jdXMoKS52YWwoJycpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xvc2VEaWFsb2coKVxuICAgIHtcbiAgICAgICAgdGhpcy5kaWFsb2dFbC5oaWRlKCk7XG4gICAgfVxuXG4gICAgaW5pdENsaWNrRXZlbnRzKClcbiAgICB7XG4gICAgICAgICQoJyNhZGRCdXR0b24nKS5jbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNob3dEaWFsb2coKTtcbiAgICAgICAgfSk7XG4gICAgICAgICQoJyNhZGREaWFsb2dDbG9zZSwgLm92ZXJsYXknKS5jbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7XG4gICAgICAgIH0pO1xuICAgICAgICAkKCcjc2VhcmNoLWNvbnRhaW5lcicpLm9uKCdjbGljaycsICc+IGRpdicsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdmFyIHNvbmcgPSB7XG4gICAgICAgICAgICAgICAgaWQ6ICQoZXZlbnQuY3VycmVudFRhcmdldCkuZGF0YSgndXJsJyksXG4gICAgICAgICAgICAgICAgdGl0bGU6ICQoZXZlbnQuY3VycmVudFRhcmdldCkuZmluZCgncC50aXRsZScpLnRleHQoKSxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6ICQoZXZlbnQuY3VycmVudFRhcmdldCkuZmluZCgnaW1nJykuYXR0cignc3JjJyksXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VybmFtZScpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5hZGRTb25nVG9QbGF5bGlzdChzb25nKTtcbiAgICAgICAgICAgICQoZXZlbnQuY3VycmVudFRhcmdldCkuYWRkQ2xhc3MoJ2FkZGVkJyk7XG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgYWRkU29uZ1RvUGxheWxpc3Qoc29uZylcbiAgICB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBZGRpbmcuLiAnICsgc29uZy5pZCk7XG4gICAgICAgIHRoaXMuc29ja2V0LmVtaXQoJ2FkZHNvbmcnLCBzb25nKTtcbiAgICB9XG59IiwibGV0IGNvbmZpZyA9IHJlcXVpcmUoJy4uL2NvbmZpZy9jb25maWcuanMnKS5kZWZhdWx0O1xuXG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU291bmRiaXRlc0NvbnRyb2xsZXJcbntcblxuICAgIGNvbnN0cnVjdG9yKClcbiAgICB7XG4gICAgICAgIHRoaXMuYnVpbGRDb250cm9scygpO1xuICAgIH1cblxuICAgIGJ1aWxkQ29udHJvbHMoKVxuICAgIHtcbiAgICAgICAgbGV0IHNvdW5kcyA9IGNvbmZpZy5zb3VuZGJpdGVzLnNvdW5kcztcbiAgICAgICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gJ3NvdW5kYml0ZXMnO1xuICAgICAgICBmb3IgKHZhciBpZCBpbiBzb3VuZHMpIHtcbiAgICAgICAgICAgIGlmIChzb3VuZHMuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHlvdXR1YmVJZCA9IHNvdW5kc1tpZF07XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSA9ICdzb3VuZGJpdGUnO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgeW91dHViZUlkKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnRleHRDb250ZW50ID0gaWQ7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICB9KTtcbiAgICAgICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTmFtZSA9PT0gJ3NvdW5kYml0ZScpIHtcbiAgICAgICAgICAgICAgICBsZXQgeW91dHViZUlkID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQuaWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5KHlvdXR1YmVJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHBsYXkoaWQpXG4gICAge1xuICAgICAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgfVxufSIsImV4cG9ydCBmdW5jdGlvbiBub3RpZnkodGl0bGUsIGNvbnRlbnQpIHtcbiAgICBpZiAod2luZG93Lk5vdGlmaWNhdGlvbikge1xuICAgICAgICBpZiAoTm90aWZpY2F0aW9uLnBlcm1pc3Npb24gPT09IFwiZ3JhbnRlZFwiKSB7XG4gICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gbmV3IE5vdGlmaWNhdGlvbih0aXRsZSwgeyAnYm9keSc6IGNvbnRlbnQsICdpY29uJzogJy9mYXZpY29uLmljbycgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBOb3RpZmljYXRpb24ucmVxdWVzdFBlcm1pc3Npb24oZnVuY3Rpb24ocGVybWlzc2lvbikge1xuICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBuZXcgTm90aWZpY2F0aW9uKHRpdGxlLCB7ICdib2R5JzogY29udGVudCwgJ2ljb24nOiAnL2Zhdmljb24uaWNvJyB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuIl19
