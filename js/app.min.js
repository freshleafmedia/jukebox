(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var JukeboxController = require("./controllers/ApplicationController.js").default;
var socket = io('//:3000');

new JukeboxController(socket);

// ----

$(window).on('scroll', function () {
    var y_scroll_pos = window.pageYOffset;
    var scroll_pos_test = 120; // set to whatever you want it to be

    if (y_scroll_pos > scroll_pos_test) {
        $('header').addClass('scrolled');
    } else {
        $('header').removeClass('scrolled');
    }
});

if (typeof navigator.serviceWorker !== 'undefined') {
    navigator.serviceWorker.register('/worker.js', {
        scope: '/'
    }).then(function (reg) {
        console.log('service worker registered', reg);
    }, function (err) {
        console.log('service worker NOT registered', err);
    });
}

},{"./controllers/ApplicationController.js":4}],2:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = {
    soundbites: require('./soundbites').default
};

},{"./soundbites":3}],3:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = {
    sounds: ['YLgKPEhyg3k', 'cdEQmpVIE4A', 'kD_xWrhZ8yI']
};

},{}],4:[function(require,module,exports){
"use strict";

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var SearchController = require("./SearchController.js").default;
var Playlist = require("./PlaylistController.js").default;
var SoundbitesController = require("./SoundbitesController.js").default;
var notify = require("../helpers/notifications.js").notify;

var ApplicationController = (function () {
    function ApplicationController(socket) {
        _classCallCheck(this, ApplicationController);

        this.socket = socket;
        this.playlists = {};
        this.setEventHandlers();
        new SearchController(socket);
        this.setupSockets();
        new SoundbitesController(socket);
    }

    _createClass(ApplicationController, [{
        key: "setupSockets",
        value: function setupSockets() {
            var _this = this;

            this.socket.on('connect', function () {
                console.log('connected to websocket server');
                $('#playButton, #pauseButton, #volupButton, #voldownButton, #shuffleSongs, #forwardButton').removeClass('disabled');
            });

            this.socket.on('disconnect', function () {
                console.log('disconnected');
                $('.media-controls .btn, #shutdown, #shuffleSongs').addClass('disabled');
            });
            this.socket.on('playlist', function (playlistData) {
                _this.setPlaylist(playlistData);
            });

            this.socket.on('songRemove', function (song) {
                _this.getPlaylist().removeSong(song);
            });

            this.socket.on('songAdd', function (song) {
                notify('Song Added', song.data.title);
            });

            this.socket.on('songStatus', function (song) {
                if (song.state === 'playing') {
                    notify('Now Playing', song.data.title);
                    _this.updateNowPlaying(song.data.title);
                }
                _this.getPlaylist().updateSongStatus(song);
            });

            this.socket.on('songPosition', function (position) {
                _this.getPlaylist().updateSongPosition(position);
            });
        }
    }, {
        key: "setEventHandlers",
        value: function setEventHandlers() {
            var _this2 = this;

            $(document).on('click', 'button[data-action]', function (e) {
                if ($(e.currentTarget).hasClass('disabled')) {
                    console.warn('Button disabled');
                    return;
                }

                // Get the action to send
                var action = $(e.currentTarget).attr('data-action');

                _this2.control(action);
            });
        }
    }, {
        key: "control",
        value: function control(action) {
            console.log('Sending action: ' + action);
            this.socket.emit('control', action);
        }
    }, {
        key: "setPlaylist",
        value: function setPlaylist(playlistData) {
            // Try and add this playlist
            this.addPlaylist(playlistData, true);

            this.playlistID = playlistData.ID;
        }
    }, {
        key: "addPlaylist",
        value: function addPlaylist(playlistData, overwrite) {
            // Check if we have already loaded this playlist
            if (overwrite === true || typeof this.playlists[playlistData.ID] === 'undefined') {
                this.playlists[playlistData.ID] = new Playlist(playlistData);
            }
        }
    }, {
        key: "getPlaylist",
        value: function getPlaylist() {
            return this.playlists[this.playlistID];
        }
    }, {
        key: "updateNowPlaying",
        value: function updateNowPlaying(title) {
            if (title == '') {
                $('title').text('Freshleaf Jukebox');
            } else {
                $('title').text(title + ' - Freshleaf Jukebox');
            }
        }
    }]);

    return ApplicationController;
})();

exports.default = ApplicationController;

},{"../helpers/notifications.js":8,"./PlaylistController.js":5,"./SearchController.js":6,"./SoundbitesController.js":7}],5:[function(require,module,exports){
'use strict';

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var PlaylistController = (function () {
    function PlaylistController(playlistData) {
        _classCallCheck(this, PlaylistController);

        this.ID = playlistData.ID;
        this.songs = [];
        this.El = $('.queue-container');
        this.build(playlistData);
    }

    _createClass(PlaylistController, [{
        key: 'build',
        value: function build(playlistData) {
            //Clear the current playlist
            this.El.html('');

            $.each(playlistData.songs, (function (index, song) {

                this.addSong(song);
            }).bind(this));
        }
    }, {
        key: 'buildSong',
        value: function buildSong(song) {
            var item = $('<div />', { 'class': 'songResult', 'id': 'song-' + song.id, 'data-state': song.state });

            var image = $('<img />', { src: song.thumbnail });
            var duration = $('<p />', { 'class': 'duration', text: (song.data.duration / 60).toFixed(2) });
            var title = $('<p />', { 'class': 'title', text: song.data.title });
            var progress = $('<progress />', { value: song.position, max: song.data.duration });
            var username = $('<p />', { 'class': 'username', text: song.username });

            var imgwrap = $('<div />', { 'class': 'imageWrapper' });
            var contentwrap = $('<div />', { 'class': 'contentWrapper' });

            imgwrap.append(image);
            contentwrap.append(title);
            contentwrap.append(progress);
            item.append(imgwrap);
            item.append(contentwrap);
            item.append(username);
            item.append(duration);

            return item;
        }
    }, {
        key: 'removeSong',
        value: function removeSong(songToRemove) {
            this.El.children('#song-' + songToRemove.id).remove();

            for (var i = 0; i < this.songs.length; i++) {
                var song = this.songs[i];

                if (song.id === songToRemove.id) {
                    this.songs.splice(i, 1);
                    break;
                }
            }
        }
    }, {
        key: 'addSong',
        value: function addSong(song) {
            this.El.append(this.buildSong(song));
        }
    }, {
        key: 'updateSongStatus',
        value: function updateSongStatus(song) {
            var songEl = this.El.find('.songResult#song-' + song.id);
            songEl.attr('data-state', song.state);
            songEl.find('.duration').text((song.data.duration / 60).toFixed(2));
            songEl.find('progress').attr('value', song.position);
            songEl.find('progress').attr('max', song.data.duration);
        }
    }, {
        key: 'updateSongPosition',
        value: function updateSongPosition(position) {
            var songEl = this.El.find('.songResult[data-state=playing]');
            songEl.find('progress').attr('value', position);
        }
    }]);

    return PlaylistController;
})();

exports.default = PlaylistController;

},{}],6:[function(require,module,exports){
'use strict';

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var SearchController = (function () {
    function SearchController(socket) {
        _classCallCheck(this, SearchController);

        this.socket = socket;
        this.dialogEl = $('#addDialog');
        this.userSetupEl = $('#user-setup');
        this.searchControlsEl = $('#search-controls');

        this.initUser();
        this.initGoogleApi(this.searchReady);
        this.initKeyEvents();
        this.initClickEvents();
    }

    _createClass(SearchController, [{
        key: 'initUser',
        value: function initUser() {
            var _this = this;

            if (localStorage.getItem('username')) {
                this.userSetupEl.hide();
                this.searchControlsEl.show();
            }
            $('#addUser').submit(function (e) {
                e.preventDefault();
                if ($('#username').val() != "") {
                    localStorage.setItem('username', $('#username').val());
                    _this.userSetupEl.hide();
                    _this.searchControlsEl.show();
                }
            });
        }
    }, {
        key: 'searchReady',
        value: function searchReady() {
            $('#search').prop('disabled', false);
        }
    }, {
        key: 'initGoogleApi',
        value: function initGoogleApi(callback) {
            setTimeout(googleApiClientReady, 1000);
            function googleApiClientReady() {
                gapi.client.setApiKey('AIzaSyC5ZNaxUE7HwOxi6r5xMq9aeRlUVdJXU7I');
                gapi.auth.init(function () {
                    gapi.client.load('youtube', 'v3', function () {
                        callback();
                    });
                });
            }
        }
    }, {
        key: 'initKeyEvents',
        value: function initKeyEvents() {
            var _this2 = this;

            $(document).keyup(function (event) {
                // Up/Down and j/k keys to navigate selecting a song
                if (event.keyCode == 40 || event.keyCode == 74) {
                    if ($('.highlight').length) {
                        var highlighted = $('.highlight');
                        highlighted.next().addClass('highlight');
                        highlighted.removeClass('highlight');
                    } else {
                        $('#search-container > .songResult:first-child').addClass('highlight');
                    }
                    return;
                }
                if (event.keyCode == 38 || event.keyCode == 75) {
                    if ($('.highlight').length) {
                        var highlighted = $('.highlight');
                        highlighted.prev().addClass('highlight');
                        highlighted.removeClass('highlight');
                    }
                    return;
                }
                // Esc closes dialog
                if (event.keyCode == 27) {
                    _this2.closeDialog();
                }
                // Run search on keydown in search box
                if ($(event.target).is('#search')) {
                    if (event.keyCode == 13 && $('.highlight').length) {
                        $('.highlight').click();
                        return;
                    }
                    _this2.search($('#search').val());
                }
                // Keys when form input isn't focused
                if (!$(event.target).is('input')) {
                    // A or Enter triggers dialog
                    if (event.keyCode == 65 || event.keyCode == 13) {
                        _this2.showDialog();
                    }
                }
            });
        }
    }, {
        key: 'search',
        value: function search(query) {
            var request = gapi.client.youtube.search.list({
                q: query,
                part: 'snippet',
                maxResults: '25'
            });

            request.execute(function (response) {
                $('#search-container').html('');
                $.each(response.result.items, function (index, item) {
                    if (item.id.kind == "youtube#video") {
                        var el = $('<div />', { 'class': 'songResult' });
                        el.data('url', item.id.videoId);
                        var image = $('<img />', { src: item.snippet.thumbnails.default.url });
                        var descWrap = $('<div />');
                        var title = $('<p />', { text: item.snippet.title, 'class': 'title' });
                        //var author = $('<p />', { text: item.snippet.channelTitle, 'class': 'description' });
                        descWrap.append(title);
                        //descWrap.append(author);
                        var imgwrap = $('<div />', { 'class': 'imageWrapper' });
                        imgwrap.append(image);
                        el.append(imgwrap);
                        el.append(descWrap);
                        $('#search-container').append(el);
                    }
                });
            });
        }
    }, {
        key: 'showDialog',
        value: function showDialog() {
            this.dialogEl.show();
            if (localStorage.getItem('username')) {
                $('#search').focus().val('');
            } else {
                $('#username').focus().val('');
            }
        }
    }, {
        key: 'closeDialog',
        value: function closeDialog() {
            this.dialogEl.hide();
        }
    }, {
        key: 'initClickEvents',
        value: function initClickEvents() {
            var _this3 = this;

            $('#addButton').click(function () {
                _this3.showDialog();
            });
            $('#addDialogClose, .overlay').click(function () {
                _this3.closeDialog();
            });
            $('#search-container').on('click', '> div', function (event) {
                var song = {
                    id: $(event.currentTarget).data('url'),
                    title: $(event.currentTarget).find('p.title').text(),
                    thumbnail: $(event.currentTarget).find('img').attr('src'),
                    username: localStorage.getItem('username')
                };
                _this3.addSongToPlaylist(song);
                $(event.currentTarget).addClass('added');
            });
        }
    }, {
        key: 'addSongToPlaylist',
        value: function addSongToPlaylist(song) {
            console.log('Adding.. ' + song.id);
            this.socket.emit('addsong', song);
        }
    }]);

    return SearchController;
})();

exports.default = SearchController;

},{}],7:[function(require,module,exports){
'use strict';

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var config = require('../config/config.js').default;

"use strict";

var SoundbitesController = (function () {
    function SoundbitesController(socket) {
        _classCallCheck(this, SoundbitesController);

        this.socket = socket;
        this.buildControls();
    }

    _createClass(SoundbitesController, [{
        key: 'buildControls',
        value: function buildControls() {
            var _this = this;

            var sounds = config.soundbites.sounds;
            var container = document.createElement('div');
            container.className = 'soundbites';
            for (var id in sounds) {
                if (sounds.hasOwnProperty(id)) {
                    var youtubeId = sounds[id];
                    var element = document.createElement('div');
                    element.className = 'soundbite';
                    element.setAttribute('data-id', youtubeId);
                    element.textContent = id;
                    container.appendChild(element);
                }
            }
            document.querySelector('body').appendChild(container);
            document.addEventListener('keyup', function () {
                container.style.display = 'flex';
            });
            container.addEventListener('click', function (event) {
                if (event.target.className === 'soundbite') {
                    var _youtubeId = event.target.dataset.id;
                    _this.play(_youtubeId);
                }
            });
        }
    }, {
        key: 'play',
        value: function play(id) {
            this.socket.emit('soundbite', id);
        }
    }]);

    return SoundbitesController;
})();

exports.default = SoundbitesController;

},{"../config/config.js":2}],8:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.notify = notify;
function notify(title, content) {
    if (window.Notification) {
        if (Notification.permission === "granted") {
            var notification = new Notification(title, { 'body': content, 'icon': '/favicon.ico' });
        } else {
            Notification.requestPermission(function (permission) {
                var notification = new Notification(title, { 'body': content, 'icon': '/favicon.ico' });
            });
        }
    }
}

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9zb3VyY2UvYXBwLmpzIiwianMvc291cmNlL2NvbmZpZy9jb25maWcuanMiLCJqcy9zb3VyY2UvY29uZmlnL3NvdW5kYml0ZXMuanMiLCJqcy9zb3VyY2UvY29udHJvbGxlcnMvQXBwbGljYXRpb25Db250cm9sbGVyLmpzIiwianMvc291cmNlL2NvbnRyb2xsZXJzL1BsYXlsaXN0Q29udHJvbGxlci5qcyIsImpzL3NvdXJjZS9jb250cm9sbGVycy9TZWFyY2hDb250cm9sbGVyLmpzIiwianMvc291cmNlL2NvbnRyb2xsZXJzL1NvdW5kYml0ZXNDb250cm9sbGVyLmpzIiwianMvc291cmNlL2hlbHBlcnMvbm90aWZpY2F0aW9ucy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsSUFBSSxpQkFBaUIsR0FBRyxPQUFPLENBQUMsd0NBQXdDLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDbEYsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDOztBQUUzQixJQUFJLGlCQUFpQixDQUFDLE1BQU0sQ0FBQzs7OztBQUFDLEFBSTlCLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLFlBQVc7QUFDOUIsUUFBSSxZQUFZLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQztBQUN0QyxRQUFJLGVBQWUsR0FBRyxHQUFHOztBQUFDLEFBRTFCLFFBQUcsWUFBWSxHQUFHLGVBQWUsRUFBRTtBQUMvQixTQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0tBQ3BDLE1BQ0k7QUFDRCxTQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0tBQ3ZDO0NBQ0osQ0FBQyxDQUFDOztBQUVILElBQUksT0FBTyxTQUFTLENBQUMs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LE1BQU0sQ0FBQyxZQUFZLEVBQUU7QUFDckIsWUFBSSxZQUFZLENBQUMsVUFBVSxLQUFLLFNBQVMsRUFBRTtBQUN2QyxnQkFBSSxZQUFZLEdBQUcsSUFBSSxZQUFZLENBQUMsS0FBSyxFQUFFLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsY0FBYyxFQUFFLENBQUMsQ0FBQztTQUMzRixNQUFNO0FBQ0gsd0JBQVksQ0FBQyxpQkFBaUIsQ0FBQyxVQUFTLFVBQVUsRUFBRTtBQUNoRCxvQkFBSSxZQUFZLEdBQUcsSUFBSSxZQUFZLENBQUMsS0FBSyxFQUFFLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsY0FBYyxFQUFFLENBQUMsQ0FBQzthQUMzRixDQUFDLENBQUM7U0FDTjtLQUNKO0NBQ0oiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwidmFyIEp1a2Vib3hDb250cm9sbGVyID0gcmVxdWlyZShcIi4vY29udHJvbGxlcnMvQXBwbGljYXRpb25Db250cm9sbGVyLmpzXCIpLmRlZmF1bHQ7XG52YXIgc29ja2V0ID0gaW8oJy8vOjMwMDAnKTtcblxubmV3IEp1a2Vib3hDb250cm9sbGVyKHNvY2tldCk7XG5cbi8vIC0tLS1cblxuJCh3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgeV9zY3JvbGxfcG9zID0gd2luZG93LnBhZ2VZT2Zmc2V0O1xuICAgIHZhciBzY3JvbGxfcG9zX3Rlc3QgPSAxMjA7ICAgICAgICAgICAgIC8vIHNldCB0byB3aGF0ZXZlciB5b3Ugd2FudCBpdCB0byBiZVxuXG4gICAgaWYoeV9zY3JvbGxfcG9zID4gc2Nyb2xsX3Bvc190ZXN0KSB7XG4gICAgICAgICQoJ2hlYWRlcicpLmFkZENsYXNzKCdzY3JvbGxlZCcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgJCgnaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ3Njcm9sbGVkJyk7XG4gICAgfVxufSk7XG5cbmlmICh0eXBlb2YgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJy93b3JrZXIuanMnLCB7XG4gICAgICAgIHNjb3BlOiAnLydcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZWcpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3NlcnZpY2Ugd29ya2VyIHJlZ2lzdGVyZWQnLCByZWcpO1xuICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3NlcnZpY2Ugd29ya2VyIE5PVCByZWdpc3RlcmVkJywgZXJyKTtcbiAgICB9KTtcbn0iLCJleHBvcnQgZGVmYXVsdCB7XG4gICAgc291bmRiaXRlczogcmVxdWlyZSgnLi9zb3VuZGJpdGVzJykuZGVmYXVsdFxufTsiLCJleHBvcnQgZGVmYXVsdCB7XG4gICAgc291bmRzOiBbXG4gICAgICAgICdZTGdLUEVoeWczaycsXG4gICAgICAgICdjZEVRbXBWSUU0QScsXG4gICAgICAgICdrRF94V3JoWjh5SSdcbiAgICBdXG59OyIsInZhciBTZWFyY2hDb250cm9sbGVyID0gcmVxdWlyZShcIi4vU2VhcmNoQ29udHJvbGxlci5qc1wiKS5kZWZhdWx0O1xudmFyIFBsYXlsaXN0ID0gcmVxdWlyZShcIi4vUGxheWxpc3RDb250cm9sbGVyLmpzXCIpLmRlZmF1bHQ7XG5sZXQgU291bmRiaXRlc0NvbnRyb2xsZXIgPSByZXF1aXJlKFwiLi9Tb3VuZGJpdGVzQ29udHJvbGxlci5qc1wiKS5kZWZhdWx0O1xudmFyIG5vdGlmeSA9IHJlcXVpcmUoXCIuLi9oZWxwZXJzL25vdGlmaWNhdGlvbnMuanNcIikubm90aWZ5O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcHBsaWNhdGlvbkNvbnRyb2xsZXJcbntcbiAgICBjb25zdHJ1Y3Rvcihzb2NrZXQpXG4gICAge1xuICAgICAgICB0aGlzLnNvY2tldCA9IHNvY2tldDtcbiAgICAgICAgdGhpcy5wbGF5bGlzdHMgPSB7fTtcbiAgICAgICAgdGhpcy5zZXRFdmVudEhhbmRsZXJzKCk7XG4gICAgICAgIG5ldyBTZWFyY2hDb250cm9sbGVyKHNvY2tldCk7XG4gICAgICAgIHRoaXMuc2V0dXBTb2NrZXRzKCk7XG4gICAgICAgIG5ldyBTb3VuZGJpdGVzQ29udHJvbGxlcihzb2NrZXQpO1xuICAgIH1cblxuICAgIHNldHVwU29ja2V0cygpXG4gICAge1xuICAgICAgICB0aGlzLnNvY2tldC5vbignY29ubmVjdCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25uZWN0ZWQgdG8gd2Vic29ja2V0IHNlcnZlcicpO1xuICAgICAgICAgICAgJCgnI3BsYXlCdXR0b24sICNwYXVzZUJ1dHRvbiwgI3ZvbHVwQnV0dG9uLCAjdm9sZG93bkJ1dHRvbiwgI3NodWZmbGVTb25ncywgI2ZvcndhcmRCdXR0b24nKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zb2NrZXQub24oJ2Rpc2Nvbm5lY3QnLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZGlzY29ubmVjdGVkJyk7XG4gICAgICAgICAgICAkKCcubWVkaWEtY29udHJvbHMgLmJ0biwgI3NodXRkb3duLCAjc2h1ZmZsZVNvbmdzJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNvY2tldC5vbigncGxheWxpc3QnLCAocGxheWxpc3REYXRhKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNldFBsYXlsaXN0KHBsYXlsaXN0RGF0YSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc29ja2V0Lm9uKCdzb25nUmVtb3ZlJywgKHNvbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZ2V0UGxheWxpc3QoKS5yZW1vdmVTb25nKHNvbmcpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnNvY2tldC5vbignc29uZ0FkZCcsIChzb25nKSA9PiB7XG4gICAgICAgICAgICBub3RpZnkoJ1NvbmcgQWRkZWQnLCBzb25nLmRhdGEudGl0bGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnNvY2tldC5vbignc29uZ1N0YXR1cycsIChzb25nKSA9PiB7XG4gICAgICAgICAgICBpZihzb25nLnN0YXRlID09PSAncGxheWluZycpIHtcbiAgICAgICAgICAgICAgICBub3RpZnkoJ05vdyBQbGF5aW5nJywgc29uZy5kYXRhLnRpdGxlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU5vd1BsYXlpbmcoc29uZy5kYXRhLnRpdGxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZ2V0UGxheWxpc3QoKS51cGRhdGVTb25nU3RhdHVzKHNvbmcpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnNvY2tldC5vbignc29uZ1Bvc2l0aW9uJywgKHBvc2l0aW9uKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmdldFBsYXlsaXN0KCkudXBkYXRlU29uZ1Bvc2l0aW9uKHBvc2l0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRIYW5kbGVycygpIHtcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJ2J1dHRvbltkYXRhLWFjdGlvbl0nLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCQoZS5jdXJyZW50VGFyZ2V0KS5oYXNDbGFzcygnZGlzYWJsZWQnKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignQnV0dG9uIGRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGFjdGlvbiB0byBzZW5kXG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gJChlLmN1cnJlbnRUYXJnZXQpLmF0dHIoJ2RhdGEtYWN0aW9uJyk7XG5cbiAgICAgICAgICAgIHRoaXMuY29udHJvbChhY3Rpb24pO1xuICAgICAgICB9KTtcblxuICAgIH1cblxuICAgIGNvbnRyb2woYWN0aW9uKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTZW5kaW5nIGFjdGlvbjogJythY3Rpb24pO1xuICAgICAgICB0aGlzLnNvY2tldC5lbWl0KCdjb250cm9sJywgYWN0aW9uKTtcbiAgICB9XG5cbiAgICBzZXRQbGF5bGlzdChwbGF5bGlzdERhdGEpXG4gICAge1xuICAgICAgICAvLyBUcnkgYW5kIGFkZCB0aGlzIHBsYXlsaXN0XG4gICAgICAgIHRoaXMuYWRkUGxheWxpc3QocGxheWxpc3REYXRhLCB0cnVlKTtcblxuICAgICAgICB0aGlzLnBsYXlsaXN0SUQgPSBwbGF5bGlzdERhdGEuSUQ7XG4gICAgfVxuXG4gICAgYWRkUGxheWxpc3QocGxheWxpc3REYXRhLCBvdmVyd3JpdGUpXG4gICAge1xuICAgICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGFscmVhZHkgbG9hZGVkIHRoaXMgcGxheWxpc3RcbiAgICAgICAgaWYgKG92ZXJ3cml0ZSA9PT0gdHJ1ZSB8fCB0eXBlb2YgdGhpcy5wbGF5bGlzdHNbcGxheWxpc3REYXRhLklEXSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRoaXMucGxheWxpc3RzW3BsYXlsaXN0RGF0YS5JRF0gPSBuZXcgUGxheWxpc3QocGxheWxpc3REYXRhKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFBsYXlsaXN0KClcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLnBsYXlsaXN0c1t0aGlzLnBsYXlsaXN0SURdO1xuICAgIH1cblxuICAgIHVwZGF0ZU5vd1BsYXlpbmcodGl0bGUpXG4gICAge1xuICAgICAgICBpZiAodGl0bGUgPT0gJycpIHtcbiAgICAgICAgICAgICQoJ3RpdGxlJykudGV4dCgnRnJlc2hsZWFmIEp1a2Vib3gnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoJ3RpdGxlJykudGV4dCh0aXRsZSArICcgLSBGcmVzaGxlYWYgSnVrZWJveCcpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYXlsaXN0Q29udHJvbGxlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihwbGF5bGlzdERhdGEpIHtcbiAgICAgICAgdGhpcy5JRCA9IHBsYXlsaXN0RGF0YS5JRDtcbiAgICAgICAgdGhpcy5zb25ncyA9IFtdO1xuICAgICAgICB0aGlzLkVsID0gJCgnLnF1ZXVlLWNvbnRhaW5lcicpO1xuICAgICAgICB0aGlzLmJ1aWxkKHBsYXlsaXN0RGF0YSk7XG4gICAgfVxuXG4gICAgYnVpbGQocGxheWxpc3REYXRhKVxuICAgIHtcbiAgICAgICAgLy9DbGVhciB0aGUgY3VycmVudCBwbGF5bGlzdFxuICAgICAgICB0aGlzLkVsLmh0bWwoJycpO1xuXG4gICAgICAgICQuZWFjaChwbGF5bGlzdERhdGEuc29uZ3MsIGZ1bmN0aW9uKGluZGV4LCBzb25nKSB7XG5cbiAgICAgICAgICAgIHRoaXMuYWRkU29uZyhzb25nKTtcblxuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIGJ1aWxkU29uZyhzb25nKVxuICAgIHtcbiAgICAgICAgdmFyIGl0ZW0gPSAkKCc8ZGl2IC8+JywgeyAnY2xhc3MnOiAnc29uZ1Jlc3VsdCcsICdpZCc6ICdzb25nLScrc29uZy5pZCwgJ2RhdGEtc3RhdGUnOiBzb25nLnN0YXRlIH0pO1xuXG4gICAgICAgIHZhciBpbWFnZSA9ICQoJzxpbWcgLz4nLCB7IHNyYzogc29uZy50aHVtYm5haWwgfSk7XG4gICAgICAgIHZhciBkdXJhdGlvbiA9ICQoJzxwIC8+JywgeyAnY2xhc3MnOiAnZHVyYXRpb24nLCB0ZXh0OiAoc29uZy5kYXRhLmR1cmF0aW9uIC8gNjApLnRvRml4ZWQoMikgfSk7XG4gICAgICAgIHZhciB0aXRsZSA9ICQoJzxwIC8+JywgeyAnY2xhc3MnOiAndGl0bGUnLCB0ZXh0OiBzb25nLmRhdGEudGl0bGUgfSk7XG4gICAgICAgIHZhciBwcm9ncmVzcyA9ICQoJzxwcm9ncmVzcyAvPicsIHsgdmFsdWU6IHNvbmcucG9zaXRpb24sIG1heDogc29uZy5kYXRhLmR1cmF0aW9uIH0pO1xuICAgICAgICB2YXIgdXNlcm5hbWUgPSAkKCc8cCAvPicsIHsgJ2NsYXNzJzogJ3VzZXJuYW1lJywgdGV4dDogc29uZy51c2VybmFtZSB9KTtcblxuICAgICAgICB2YXIgaW1nd3JhcCA9ICQoJzxkaXYgLz4nLCB7ICdjbGFzcyc6ICdpbWFnZVdyYXBwZXInIH0pO1xuICAgICAgICB2YXIgY29udGVudHdyYXAgPSAkKCc8ZGl2IC8+JywgeyAnY2xhc3MnOiAnY29udGVudFdyYXBwZXInIH0pO1xuXG4gICAgICAgIGltZ3dyYXAuYXBwZW5kKGltYWdlKTtcbiAgICAgICAgY29udGVudHdyYXAuYXBwZW5kKHRpdGxlKTtcbiAgICAgICAgY29udGVudHdyYXAuYXBwZW5kKHByb2dyZXNzKTtcbiAgICAgICAgaXRlbS5hcHBlbmQoaW1nd3JhcCk7XG4gICAgICAgIGl0ZW0uYXBwZW5kKGNvbnRlbnR3cmFwKTtcbiAgICAgICAgaXRlbS5hcHBlbmQodXNlcm5hbWUpO1xuICAgICAgICBpdGVtLmFwcGVuZChkdXJhdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfVxuXG4gICAgcmVtb3ZlU29uZyhzb25nVG9SZW1vdmUpXG4gICAge1xuICAgICAgICB0aGlzLkVsLmNoaWxkcmVuKCcjc29uZy0nK3NvbmdUb1JlbW92ZS5pZCkucmVtb3ZlKCk7XG5cbiAgICAgICAgZm9yICh2YXIgaT0wOyBpPHRoaXMuc29uZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzb25nID0gdGhpcy5zb25nc1tpXTtcblxuICAgICAgICAgICAgaWYoc29uZy5pZCA9PT0gc29uZ1RvUmVtb3ZlLmlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zb25ncy5zcGxpY2UoaSwxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFkZFNvbmcoc29uZylcbiAgICB7XG4gICAgICAgIHRoaXMuRWwuYXBwZW5kKHRoaXMuYnVpbGRTb25nKHNvbmcpKTtcbiAgICB9XG5cbiAgICB1cGRhdGVTb25nU3RhdHVzKHNvbmcpXG4gICAge1xuICAgICAgICB2YXIgc29uZ0VsID0gdGhpcy5FbC5maW5kKCcuc29uZ1Jlc3VsdCNzb25nLScgKyBzb25nLmlkKTtcbiAgICAgICAgc29uZ0VsLmF0dHIoJ2RhdGEtc3RhdGUnLCBzb25nLnN0YXRlKTtcbiAgICAgICAgc29uZ0VsLmZpbmQoJy5kdXJhdGlvbicpLnRleHQoKHNvbmcuZGF0YS5kdXJhdGlvbiAvIDYwKS50b0ZpeGVkKDIpKTtcbiAgICAgICAgc29uZ0VsLmZpbmQoJ3Byb2dyZXNzJykuYXR0cigndmFsdWUnLCBzb25nLnBvc2l0aW9uKTtcbiAgICAgICAgc29uZ0VsLmZpbmQoJ3Byb2dyZXNzJykuYXR0cignbWF4Jywgc29uZy5kYXRhLmR1cmF0aW9uKTtcbiAgICB9XG5cbiAgICB1cGRhdGVTb25nUG9zaXRpb24ocG9zaXRpb24pXG4gICAge1xuICAgICAgICB2YXIgc29uZ0VsID0gdGhpcy5FbC5maW5kKCcuc29uZ1Jlc3VsdFtkYXRhLXN0YXRlPXBsYXlpbmddJyk7XG4gICAgICAgIHNvbmdFbC5maW5kKCdwcm9ncmVzcycpLmF0dHIoJ3ZhbHVlJywgcG9zaXRpb24pO1xuICAgIH1cbn1cblxuXG5cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlYXJjaENvbnRyb2xsZXJcbntcbiAgICBjb25zdHJ1Y3Rvcihzb2NrZXQpIHtcbiAgICAgICAgdGhpcy5zb2NrZXQgPSBzb2NrZXQ7XG4gICAgICAgIHRoaXMuZGlhbG9nRWwgPSAkKCcjYWRkRGlhbG9nJyk7XG4gICAgICAgIHRoaXMudXNlclNldHVwRWwgPSAkKCcjdXNlci1zZXR1cCcpO1xuICAgICAgICB0aGlzLnNlYXJjaENvbnRyb2xzRWwgPSAkKCcjc2VhcmNoLWNvbnRyb2xzJyk7XG5cbiAgICAgICAgdGhpcy5pbml0VXNlcigpO1xuICAgICAgICB0aGlzLmluaXRHb29nbGVBcGkodGhpcy5zZWFyY2hSZWFkeSk7XG4gICAgICAgIHRoaXMuaW5pdEtleUV2ZW50cygpO1xuICAgICAgICB0aGlzLmluaXRDbGlja0V2ZW50cygpO1xuICAgIH1cblxuICAgIGluaXRVc2VyKClcbiAgICB7XG4gICAgICAgIGlmKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VybmFtZScpKSB7XG4gICAgICAgICAgICB0aGlzLnVzZXJTZXR1cEVsLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoQ29udHJvbHNFbC5zaG93KCk7XG4gICAgICAgIH1cbiAgICAgICAgJCgnI2FkZFVzZXInKS5zdWJtaXQoKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmICgkKCcjdXNlcm5hbWUnKS52YWwoKSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJuYW1lJywgJCgnI3VzZXJuYW1lJykudmFsKCkpO1xuICAgICAgICAgICAgICAgIHRoaXMudXNlclNldHVwRWwuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoQ29udHJvbHNFbC5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNlYXJjaFJlYWR5KClcbiAgICB7XG4gICAgICAgICQoJyNzZWFyY2gnKS5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICB9XG5cbiAgICBpbml0R29vZ2xlQXBpKGNhbGxiYWNrKVxuICAgIHtcbiAgICAgICAgc2V0VGltZW91dChnb29nbGVBcGlDbGllbnRSZWFkeSwgMTAwMCk7XG4gICAgICAgIGZ1bmN0aW9uIGdvb2dsZUFwaUNsaWVudFJlYWR5KCkge1xuICAgICAgICAgICAgZ2FwaS5jbGllbnQuc2V0QXBpS2V5KCdBSXphU3lDNVpOYXhVRTdId094aTZyNXhNcTlhZVJsVVZkSlhVN0knKTtcbiAgICAgICAgICAgIGdhcGkuYXV0aC5pbml0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGdhcGkuY2xpZW50LmxvYWQoJ3lvdXR1YmUnLCAndjMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGluaXRLZXlFdmVudHMoKSB7XG4gICAgICAgICQoZG9jdW1lbnQpLmtleXVwKChldmVudCkgPT4ge1xuICAgICAgICAgICAgLy8gVXAvRG93biBhbmQgai9rIGtleXMgdG8gbmF2aWdhdGUgc2VsZWN0aW5nIGEgc29uZ1xuICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gNDAgfHwgZXZlbnQua2V5Q29kZSA9PSA3NCkge1xuICAgICAgICAgICAgICAgIGlmICgkKCcuaGlnaGxpZ2h0JykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoaWdobGlnaHRlZCA9ICQoJy5oaWdobGlnaHQnKTtcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWQubmV4dCgpLmFkZENsYXNzKCdoaWdobGlnaHQnKTtcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWQucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICQoJyNzZWFyY2gtY29udGFpbmVyID4gLnNvbmdSZXN1bHQ6Zmlyc3QtY2hpbGQnKS5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09IDM4IHx8IGV2ZW50LmtleUNvZGUgPT0gNzUpIHtcbiAgICAgICAgICAgICAgICBpZiAoJCgnLmhpZ2hsaWdodCcpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGlnaGxpZ2h0ZWQgPSAkKCcuaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkLnByZXYoKS5hZGRDbGFzcygnaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkLnJlbW92ZUNsYXNzKCdoaWdobGlnaHQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRXNjIGNsb3NlcyBkaWFsb2dcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09IDI3KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gUnVuIHNlYXJjaCBvbiBrZXlkb3duIGluIHNlYXJjaCBib3hcbiAgICAgICAgICAgIGlmICgkKGV2ZW50LnRhcmdldCkuaXMoJyNzZWFyY2gnKSkge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09IDEzICYmICQoJy5oaWdobGlnaHQnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCgnLmhpZ2hsaWdodCcpLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2goJCgnI3NlYXJjaCcpLnZhbCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEtleXMgd2hlbiBmb3JtIGlucHV0IGlzbid0IGZvY3VzZWRcbiAgICAgICAgICAgIGlmICghJChldmVudC50YXJnZXQpLmlzKCdpbnB1dCcpKSB7XG4gICAgICAgICAgICAgICAgLy8gQSBvciBFbnRlciB0cmlnZ2VycyBkaWFsb2dcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSA2NSB8fCBldmVudC5rZXlDb2RlID09IDEzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0RpYWxvZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2VhcmNoKHF1ZXJ5KVxuICAgIHtcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBnYXBpLmNsaWVudC55b3V0dWJlLnNlYXJjaC5saXN0KHtcbiAgICAgICAgICAgIHE6IHF1ZXJ5LFxuICAgICAgICAgICAgcGFydDogJ3NuaXBwZXQnLFxuICAgICAgICAgICAgbWF4UmVzdWx0czogJzI1J1xuICAgICAgICB9KTtcblxuICAgICAgICByZXF1ZXN0LmV4ZWN1dGUoKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAkKCcjc2VhcmNoLWNvbnRhaW5lcicpLmh0bWwoJycpO1xuICAgICAgICAgICAgJC5lYWNoKHJlc3BvbnNlLnJlc3VsdC5pdGVtcywgZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uaWQua2luZCA9PSBcInlvdXR1YmUjdmlkZW9cIikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSAkKCc8ZGl2IC8+JywgeydjbGFzcyc6ICdzb25nUmVzdWx0J30pO1xuICAgICAgICAgICAgICAgICAgICBlbC5kYXRhKCd1cmwnLCBpdGVtLmlkLnZpZGVvSWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW1hZ2UgPSAkKCc8aW1nIC8+Jywge3NyYzogaXRlbS5zbmlwcGV0LnRodW1ibmFpbHMuZGVmYXVsdC51cmx9KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlc2NXcmFwID0gJCgnPGRpdiAvPicpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSAkKCc8cCAvPicsIHt0ZXh0OiBpdGVtLnNuaXBwZXQudGl0bGUsICdjbGFzcyc6ICd0aXRsZSd9KTtcbiAgICAgICAgICAgICAgICAgICAgLy92YXIgYXV0aG9yID0gJCgnPHAgLz4nLCB7IHRleHQ6IGl0ZW0uc25pcHBldC5jaGFubmVsVGl0bGUsICdjbGFzcyc6ICdkZXNjcmlwdGlvbicgfSk7XG4gICAgICAgICAgICAgICAgICAgIGRlc2NXcmFwLmFwcGVuZCh0aXRsZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vZGVzY1dyYXAuYXBwZW5kKGF1dGhvcik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbWd3cmFwID0gJCgnPGRpdiAvPicsIHsnY2xhc3MnOiAnaW1hZ2VXcmFwcGVyJ30pO1xuICAgICAgICAgICAgICAgICAgICBpbWd3cmFwLmFwcGVuZChpbWFnZSk7XG4gICAgICAgICAgICAgICAgICAgIGVsLmFwcGVuZChpbWd3cmFwKTtcbiAgICAgICAgICAgICAgICAgICAgZWwuYXBwZW5kKGRlc2NXcmFwKTtcbiAgICAgICAgICAgICAgICAgICAgJCgnI3NlYXJjaC1jb250YWluZXInKS5hcHBlbmQoZWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNob3dEaWFsb2coKSB7XG4gICAgICAgIHRoaXMuZGlhbG9nRWwuc2hvdygpO1xuICAgICAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJuYW1lJykpIHtcbiAgICAgICAgICAgICQoJyNzZWFyY2gnKS5mb2N1cygpLnZhbCgnJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKCcjdXNlcm5hbWUnKS5mb2N1cygpLnZhbCgnJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjbG9zZURpYWxvZygpXG4gICAge1xuICAgICAgICB0aGlzLmRpYWxvZ0VsLmhpZGUoKTtcbiAgICB9XG5cbiAgICBpbml0Q2xpY2tFdmVudHMoKVxuICAgIHtcbiAgICAgICAgJCgnI2FkZEJ1dHRvbicpLmNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0RpYWxvZygpO1xuICAgICAgICB9KTtcbiAgICAgICAgJCgnI2FkZERpYWxvZ0Nsb3NlLCAub3ZlcmxheScpLmNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgfSk7XG4gICAgICAgICQoJyNzZWFyY2gtY29udGFpbmVyJykub24oJ2NsaWNrJywgJz4gZGl2JywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB2YXIgc29uZyA9IHtcbiAgICAgICAgICAgICAgICBpZDogJChldmVudC5jdXJyZW50VGFyZ2V0KS5kYXRhKCd1cmwnKSxcbiAgICAgICAgICAgICAgICB0aXRsZTogJChldmVudC5jdXJyZW50VGFyZ2V0KS5maW5kKCdwLnRpdGxlJykudGV4dCgpLFxuICAgICAgICAgICAgICAgIHRodW1ibmFpbDogJChldmVudC5jdXJyZW50VGFyZ2V0KS5maW5kKCdpbWcnKS5hdHRyKCdzcmMnKSxcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJuYW1lJylcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmFkZFNvbmdUb1BsYXlsaXN0KHNvbmcpO1xuICAgICAgICAgICAgJChldmVudC5jdXJyZW50VGFyZ2V0KS5hZGRDbGFzcygnYWRkZWQnKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICBhZGRTb25nVG9QbGF5bGlzdChzb25nKVxuICAgIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0FkZGluZy4uICcgKyBzb25nLmlkKTtcbiAgICAgICAgdGhpcy5zb2NrZXQuZW1pdCgnYWRkc29uZycsIHNvbmcpO1xuICAgIH1cbn0iLCJsZXQgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2NvbmZpZy5qcycpLmRlZmF1bHQ7XG5cblwidXNlIHN0cmljdFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTb3VuZGJpdGVzQ29udHJvbGxlclxue1xuXG4gICAgY29uc3RydWN0b3Ioc29ja2V0KVxuICAgIHtcbiAgICAgICAgdGhpcy5zb2NrZXQgPSBzb2NrZXQ7XG4gICAgICAgIHRoaXMuYnVpbGRDb250cm9scygpO1xuICAgIH1cblxuICAgIGJ1aWxkQ29udHJvbHMoKVxuICAgIHtcbiAgICAgICAgbGV0IHNvdW5kcyA9IGNvbmZpZy5zb3VuZGJpdGVzLnNvdW5kcztcbiAgICAgICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gJ3NvdW5kYml0ZXMnO1xuICAgICAgICBmb3IgKHZhciBpZCBpbiBzb3VuZHMpIHtcbiAgICAgICAgICAgIGlmIChzb3VuZHMuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHlvdXR1YmVJZCA9IHNvdW5kc1tpZF07XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSA9ICdzb3VuZGJpdGUnO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgeW91dHViZUlkKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnRleHRDb250ZW50ID0gaWQ7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICB9KTtcbiAgICAgICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTmFtZSA9PT0gJ3NvdW5kYml0ZScpIHtcbiAgICAgICAgICAgICAgICBsZXQgeW91dHViZUlkID0gZXZlbnQudGFyZ2V0LmRhdGFzZXQuaWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5KHlvdXR1YmVJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHBsYXkoaWQpXG4gICAge1xuICAgICAgICB0aGlzLnNvY2tldC5lbWl0KCdzb3VuZGJpdGUnLCBpZCk7XG4gICAgfVxufSIsImV4cG9ydCBmdW5jdGlvbiBub3RpZnkodGl0bGUsIGNvbnRlbnQpIHtcbiAgICBpZiAod2luZG93Lk5vdGlmaWNhdGlvbikge1xuICAgICAgICBpZiAoTm90aWZpY2F0aW9uLnBlcm1pc3Npb24gPT09IFwiZ3JhbnRlZFwiKSB7XG4gICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gbmV3IE5vdGlmaWNhdGlvbih0aXRsZSwgeyAnYm9keSc6IGNvbnRlbnQsICdpY29uJzogJy9mYXZpY29uLmljbycgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBOb3RpZmljYXRpb24ucmVxdWVzdFBlcm1pc3Npb24oZnVuY3Rpb24ocGVybWlzc2lvbikge1xuICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBuZXcgTm90aWZpY2F0aW9uKHRpdGxlLCB7ICdib2R5JzogY29udGVudCwgJ2ljb24nOiAnL2Zhdmljb24uaWNvJyB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuIl19
